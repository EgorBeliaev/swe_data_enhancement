[
    {
        "title": "[otlp] Expand array buffer / add tests to existing base buffer"
    },
    {
        "author": {
            "login": "PR Description"
        },
        "body": "Fixes Part of #5730\r\nDesign discussion issue #\r\n\r\n## Changes\r\n\r\nPlease provide a brief description of the changes here.\r\n\r\n* Expanded the array buffer when a limit is reached.\r\n* Set the upper limit for the array buffer to 2 MB. If a single tag with an array value exceeds 2 MB, it will be dropped, and the value will be updated to \"TRUNCATED.\" While dropping the entire array value tag would be simpler, it would make it harder for customers to identify the issue.\r\n* Added additional test for base buffer increase\r\n* Identified a bug where `ArgumentException` could be thrown when using these calls \r\n  - Buffer.BlockCopy(value.Buffer, 0, state.Buffer, state.WritePosition, value.WritePosition);\r\n  - var bytesWritten = Utf8Encoding.GetBytes(value, buffer.AsSpan().Slice(writePosition));\r\n * Identified another bug where the buffer needs to be passed by reference, as it is being doubled in a different method.\r\n \r\n\r\n## Merge requirement checklist\r\n\r\n* [X] [CONTRIBUTING](https://github.com/open-telemetry/opentelemetry-dotnet/blob/main/CONTRIBUTING.md) guidelines followed (license requirements, nullable enabled, static analysis, etc.)\r\n* [X] Unit tests added/updated\r\n* [ ] Appropriate `CHANGELOG.md` files updated for non-trivial changes\r\n* [ ] Changes in public API reviewed (if applicable)\r\n"
    },
    {
        "author": {
            "login": "rajkumar-rangaraj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "CodeBlanch"
        },
        "body": ""
    },
    {
        "author": {
            "login": "CodeBlanch"
        },
        "body": "LGTM"
    },
    {
        "author": {
            "login": "rajkumar-rangaraj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "codecov"
        },
        "body": "## [Codecov](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) Report\nAttention: Patch coverage is `89.28571%` with `3 lines` in your changes missing coverage. Please review.\n> Project coverage is 86.45%. Comparing base [(`145e7ad`)](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/commit/145e7ade6f3d518280d139624951822117b60ebd?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) to head [(`0218bd2`)](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/commit/0218bd21a6c7578a46468769e0e5261d47713fdc?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry).\n> Report is 1 commits behind head on main.\n\n| [Files with missing lines](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | Patch % | Lines |\n|---|---|---|\n| [...Implementation/Serializer/ProtobufOtlpTagWriter.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FImplementation%2FSerializer%2FProtobufOtlpTagWriter.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL0ltcGxlbWVudGF0aW9uL1NlcmlhbGl6ZXIvUHJvdG9idWZPdGxwVGFnV3JpdGVyLmNz) | 75.00% | [3 Missing :warning: ](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) |\n\n<details><summary>Additional details and impacted files</summary>\n\n\n[![Impacted file tree graph](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013/graphs/tree.svg?width=650&height=150&src=pr&token=vscyfvPfy5&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry)](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry)\n\n```diff\n@@            Coverage Diff             @@\n##             main    #6013      +/-   ##\n==========================================\n+ Coverage   86.29%   86.45%   +0.15%     \n==========================================\n  Files         257      257              \n  Lines       11685    11699      +14     \n==========================================\n+ Hits        10084    10114      +30     \n+ Misses       1601     1585      -16     \n```\n\n| [Flag](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013/flags?src=pr&el=flags&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | Coverage \u0394 | |\n|---|---|---|\n| [unittests-Project-Experimental](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | `86.29% <89.28%> (+0.13%)` | :arrow_up: |\n| [unittests-Project-Stable](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | `86.38% <89.28%> (+0.22%)` | :arrow_up: |\n| [unittests-Solution](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | `86.08% <89.28%> (-0.16%)` | :arrow_down: |\n| [unittests-UnstableCoreLibraries-Experimental](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | `85.78% <\u00f8> (\u00f8)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Files with missing lines](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry) | Coverage \u0394 | |\n|---|---|---|\n| [...tation/OpenTelemetryProtocolExporterEventSource.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FImplementation%2FOpenTelemetryProtocolExporterEventSource.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL0ltcGxlbWVudGF0aW9uL09wZW5UZWxlbWV0cnlQcm90b2NvbEV4cG9ydGVyRXZlbnRTb3VyY2UuY3M=) | `84.00% <100.00%> (-3.68%)` | :arrow_down: |\n| [...ementation/Serializer/ProtobufOtlpLogSerializer.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FImplementation%2FSerializer%2FProtobufOtlpLogSerializer.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL0ltcGxlbWVudGF0aW9uL1NlcmlhbGl6ZXIvUHJvdG9idWZPdGxwTG9nU2VyaWFsaXplci5jcw==) | `98.47% <100.00%> (+3.05%)` | :arrow_up: |\n| [...ntation/Serializer/ProtobufOtlpMetricSerializer.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FImplementation%2FSerializer%2FProtobufOtlpMetricSerializer.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL0ltcGxlbWVudGF0aW9uL1NlcmlhbGl6ZXIvUHJvdG9idWZPdGxwTWV0cmljU2VyaWFsaXplci5jcw==) | `98.77% <100.00%> (+1.63%)` | :arrow_up: |\n| [...entation/Serializer/ProtobufOtlpTraceSerializer.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FImplementation%2FSerializer%2FProtobufOtlpTraceSerializer.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL0ltcGxlbWVudGF0aW9uL1NlcmlhbGl6ZXIvUHJvdG9idWZPdGxwVHJhY2VTZXJpYWxpemVyLmNz) | `94.98% <100.00%> (+1.54%)` | :arrow_up: |\n| [...ol/Implementation/Serializer/ProtobufSerializer.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FImplementation%2FSerializer%2FProtobufSerializer.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL0ltcGxlbWVudGF0aW9uL1NlcmlhbGl6ZXIvUHJvdG9idWZTZXJpYWxpemVyLmNz) | `93.18% <100.00%> (+5.48%)` | :arrow_up: |\n| [....Exporter.OpenTelemetryProtocol/OtlpLogExporter.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FOtlpLogExporter.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL090bHBMb2dFeHBvcnRlci5jcw==) | `100.00% <100.00%> (\u00f8)` | |\n| [...porter.OpenTelemetryProtocol/OtlpMetricExporter.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FOtlpMetricExporter.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL090bHBNZXRyaWNFeHBvcnRlci5jcw==) | `80.76% <100.00%> (\u00f8)` | |\n| [...xporter.OpenTelemetryProtocol/OtlpTraceExporter.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FOtlpTraceExporter.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL090bHBUcmFjZUV4cG9ydGVyLmNz) | `89.28% <100.00%> (\u00f8)` | |\n| [...Implementation/Serializer/ProtobufOtlpTagWriter.cs](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013?src=pr&el=tree&filepath=src%2FOpenTelemetry.Exporter.OpenTelemetryProtocol%2FImplementation%2FSerializer%2FProtobufOtlpTagWriter.cs&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry#diff-c3JjL09wZW5UZWxlbWV0cnkuRXhwb3J0ZXIuT3BlblRlbGVtZXRyeVByb3RvY29sL0ltcGxlbWVudGF0aW9uL1NlcmlhbGl6ZXIvUHJvdG9idWZPdGxwVGFnV3JpdGVyLmNz) | `95.45% <75.00%> (-4.55%)` | :arrow_down: |\n\n... and [4 files with indirect coverage changes](https://app.codecov.io/gh/open-telemetry/opentelemetry-dotnet/pull/6013/indirect-changes?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=open-telemetry)\n\n</details>"
    }
]