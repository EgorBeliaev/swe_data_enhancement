**Instructions for Changes:**

1. **Fix Key Bug:**
   - Address the bug related to setting key budget metrics in `prometheus.py`.
   
2. **Ensure Compatibility:**
   - Make sure custom metadata works correctly with the key budget metric.

3. **Testing:**
   - Provide a screenshot of any new tests passing locally.
   - If there are UI changes, include a screenshot or GIF demonstrating the working UI fixes.

4. **Note on Root Cause:**
   - A separate branch contains the root cause analysis. Ensure it is reviewed in conjunction.