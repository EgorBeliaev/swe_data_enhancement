The pull request introduces a concurrency lock mechanism for all API methods that modify user permissions. This change is necessary to prevent undefined states resulting from concurrent requests trying to update the same user's permissions. The proposed solution ensures that each request completes its processing before another request can begin altering permissions, thereby maintaining the expected state after each request. This PR replaces previous PRs #22957 and #22931.