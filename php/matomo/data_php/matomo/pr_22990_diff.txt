diff --git a/plugins/CoreHome/vue/dist/CoreHome.umd.js b/plugins/CoreHome/vue/dist/CoreHome.umd.js
index 0fcbafa085f..78fbcd10294 100644
--- a/plugins/CoreHome/vue/dist/CoreHome.umd.js
+++ b/plugins/CoreHome/vue/dist/CoreHome.umd.js
@@ -1490,6 +1490,8 @@ var AjaxHelper_AjaxHelper = /*#__PURE__*/function () {
 
     AjaxHelper_defineProperty(this, "abortController", null);
 
+    AjaxHelper_defineProperty(this, "abortable", true);
+
     AjaxHelper_defineProperty(this, "defaultParams", ['idSite', 'period', 'date', 'segment']);
 
     AjaxHelper_defineProperty(this, "resolveWithHelper", false);
@@ -1726,7 +1728,10 @@ var AjaxHelper_AjaxHelper = /*#__PURE__*/function () {
       }
 
       this.requestHandle = this.buildAjaxCall();
-      window.globalAjaxQueue.push(this.requestHandle);
+
+      if (this.abortable) {
+        window.globalAjaxQueue.push(this.requestHandle);
+      }
 
       if (this.abortController) {
         this.abortController.signal.addEventListener('abort', function () {
@@ -1812,7 +1817,9 @@ var AjaxHelper_AjaxHelper = /*#__PURE__*/function () {
         complete: this.completeCallback,
         headers: this.headers ? this.headers : undefined,
         error: function errorCallback() {
-          window.globalAjaxQueue.active -= 1;
+          if (self.abortable) {
+            window.globalAjaxQueue.active -= 1;
+          }
 
           if (self.errorCallback) {
             for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
@@ -1881,7 +1888,9 @@ var AjaxHelper_AjaxHelper = /*#__PURE__*/function () {
             _this3.callback(response, status, request);
           }
 
-          window.globalAjaxQueue.active -= 1;
+          if (self.abortable) {
+            window.globalAjaxQueue.active -= 1;
+          }
 
           if (Matomo_Matomo.ajaxRequestFinished) {
             Matomo_Matomo.ajaxRequestFinished();
@@ -2104,6 +2113,10 @@ var AjaxHelper_AjaxHelper = /*#__PURE__*/function () {
         helper.resolveWithHelper = true;
       }
 
+      if (options.abortable === false) {
+        helper.abortable = false;
+      }
+
       return helper.send().then(function (result) {
         var data = result instanceof AjaxHelper ? result.requestHandle.responseJSON : result; // check for error if not using default notification behavior
 
@@ -6494,7 +6507,8 @@ var SitesStore_SitesStore = /*#__PURE__*/function () {
           pattern: term,
           sitesToExclude: sitesToExclude
         }, {
-          abortController: _this3.currentRequestAbort
+          abortController: _this3.currentRequestAbort,
+          abortable: false
         });
       }).then(function (response) {
         if (response) {
diff --git a/plugins/CoreHome/vue/dist/CoreHome.umd.min.js b/plugins/CoreHome/vue/dist/CoreHome.umd.min.js
index 4eacef52a04..0bcde508223 100644
--- a/plugins/CoreHome/vue/dist/CoreHome.umd.min.js
+++ b/plugins/CoreHome/vue/dist/CoreHome.umd.min.js
@@ -79,7 +79,7 @@ function de(e,t){return be(e)||he(e,t)||pe(e,t)||me()}function me(){throw new Ty
  *
  * @link    https://matomo.org
  * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
- */we.updatePeriodParamsFromUrl=Ee.updatePeriodParamsFromUrl.bind(Ee);var Je=window,Ke=Je.$;function Qe(e,t){"abort"!==t&&e&&0!==e.status&&("undefined"!==typeof Piwik_Popover?Piwik_Popover.isOpen()&&e&&500===e.status?Ke(document.body).html(piwikHelper.escape(e.responseText)):Ke("#loadingError").show():console.log("Request failed: ".concat(e.responseText)))}window.globalAjaxQueue=[],window.globalAjaxQueue.active=0,window.globalAjaxQueue.clean=function(){for(var e=this.length;e>=0;e-=1)this[e]&&4!==this[e].readyState||this.splice(e,1)},window.globalAjaxQueue.push=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this.active+=n.length,this.clean(),(e=Array.prototype.push).call.apply(e,[this].concat(n))},window.globalAjaxQueue.abort=function(){this.forEach((function(e){return e&&e.abort&&e.abort()})),this.splice(0,this.length),this.active=0};var Xe=function(e){_e(n,e);var t=Re(n);function n(){return Fe(this,n),t.apply(this,arguments)}return n}($e(Error)),Ze=function(){function e(){Fe(this,e),Le(this,"format","json"),Le(this,"timeout",null),Le(this,"callback",null),Le(this,"useRegularCallbackInCaseOfError",!1),Le(this,"errorCallback",void 0),Le(this,"withToken",!1),Le(this,"completeCallback",void 0),Le(this,"getParams",{}),Le(this,"getUrl","?"),Le(this,"postParams",{}),Le(this,"loadingElement",null),Le(this,"errorElement","#ajaxError"),Le(this,"headers",{"X-Requested-With":"XMLHttpRequest"}),Le(this,"requestHandle",null),Le(this,"abortController",null),Le(this,"defaultParams",["idSite","period","date","segment"]),Le(this,"resolveWithHelper",!1),this.errorCallback=Qe}return Me(e,[{key:"addParams",value:function(e,t){var n=this,r="string"===typeof e?window.broadcast.getValuesFromUrl(e):e,o=["compareSegments","comparePeriods","compareDates"];Object.keys(r).forEach((function(e){var a=r[e];(-1===o.indexOf(e)||a)&&("boolean"===typeof a&&(a=a?1:0),"get"===t.toLowerCase()?n.getParams[e]=a:"post"===t.toLowerCase()&&(n.postParams[e]=a))}))}},{key:"withTokenInUrl",value:function(){this.withToken=!0}},{key:"setUrl",value:function(e){this.addParams(broadcast.getValuesFromUrl(e),"GET")}},{key:"setBulkRequests",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e){return"string"===typeof e?e:Ke.param(e)}));this.addParams({module:"API",method:"API.getBulkRequest",urls:r,format:"json"},"post")}},{key:"setTimeout",value:function(e){this.timeout=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"useCallbackInCaseOfError",value:function(){this.useRegularCallbackInCaseOfError=!0}},{key:"redirectOnSuccess",value:function(e){this.setCallback((function(){piwikHelper.redirect(e)}))}},{key:"setErrorCallback",value:function(e){this.errorCallback=e}},{key:"setCompleteCallback",value:function(e){this.completeCallback=e}},{key:"setFormat",value:function(e){this.format=e}},{key:"setLoadingElement",value:function(e){this.loadingElement=e||"#ajaxLoadingDiv"}},{key:"setErrorElement",value:function(e){e&&(this.errorElement=e)}},{key:"useGETDefaultParameter",value:function(e){if(e&&this.defaultParams)for(var t=0;t<this.defaultParams.length;t+=1)if(this.defaultParams[t]===e)return!0;return!1}},{key:"removeDefaultParameter",value:function(e){if(e&&this.defaultParams)for(var t=0;t<this.defaultParams.length;t+=1)this.defaultParams[t]===e&&this.defaultParams.splice(t,1)}},{key:"send",value:function(){var e=this;Ke(this.errorElement).length&&Ke(this.errorElement).hide(),this.loadingElement&&Ke(this.loadingElement).fadeIn(),this.requestHandle=this.buildAjaxCall(),window.globalAjaxQueue.push(this.requestHandle),this.abortController&&this.abortController.signal.addEventListener("abort",(function(){e.requestHandle&&e.requestHandle.abort()}));var t=new Promise((function(t,n){e.requestHandle.then((function(n){e.resolveWithHelper?t(e):t(n)})).fail((function(t){if(429===t.status)return console.log("Warning: the '".concat(Ke.param(e.getParams),"' request was rate limited!")),void n(t);"abort"!==t.statusText&&0!==t.status&&(console.log("Warning: the ".concat(Ke.param(e.getParams)," request failed!")),n(t))}))}));return t}},{key:"abort",value:function(){this.requestHandle&&"function"===typeof this.requestHandle.abort&&(this.requestHandle.abort(),this.requestHandle=null)}},{key:"buildAjaxCall",value:function(){var e=this,t=this,n=this.mixinDefaultGetParams(this.getParams),r=this.getUrl;"?"!==r[r.length-1]&&(r+="&"),n.segment&&(r="".concat(r,"segment=").concat(n.segment,"&"),delete n.segment),n.date&&(r="".concat(r,"date=").concat(decodeURIComponent(n.date.toString()),"&"),delete n.date),r+=Ke.param(n);var o={type:"POST",async:!0,url:r,dataType:this.format||"json",complete:this.completeCallback,headers:this.headers?this.headers:void 0,error:function(){if(window.globalAjaxQueue.active-=1,t.errorCallback){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.errorCallback.apply(this,n)}},success:function(t,n,r){e.loadingElement&&Ke(e.loadingElement).hide();var o="API.getBulkRequest"===e.postParams.method&&Array.isArray(t)?t:[t],a=o.filter((function(e){return"error"===e.result})).map((function(e){return e.message})).filter((function(e){return e.length})).reduce((function(e,t){return e[t]=(e[t]||0)+1,e}),{});if(a&&Object.keys(a).length&&!e.useRegularCallbackInCaseOfError){var i="";Object.keys(a).forEach((function(e){i.length&&(i+="<br />"),a[e]>1?i+="".concat(e," (").concat(a[e],"x)"):i+=e}));var l=null,c="toast";Ke(e.errorElement).length&&i.length&&(Ke(e.errorElement).show(),l=e.errorElement,c=null);var s=!document.querySelector("#login_form");if(i&&s){var u=window["require"]("piwik/UI"),d=new u.Notification;d.show(i,{placeat:l,context:"error",type:c,id:"ajaxHelper"}),d.scrollToNotification()}}else e.callback&&e.callback(t,n,r);window.globalAjaxQueue.active-=1,ue.ajaxRequestFinished&&ue.ajaxRequestFinished()},data:this.mixinDefaultPostParams(this.postParams),timeout:null!==this.timeout?this.timeout:void 0};return Ke.ajax(o)}},{key:"isRequestToApiMethod",value:function(){return this.getParams&&"API"===this.getParams.module&&this.getParams.method||this.postParams&&"API"===this.postParams.module&&this.postParams.method}},{key:"isWidgetizedRequest",value:function(){return"Widgetize"===broadcast.getValueFromUrl("module")}},{key:"getDefaultPostParams",value:function(){return this.withToken||this.isRequestToApiMethod()||ue.shouldPropagateTokenAuth?{token_auth:ue.token_auth,force_api_session:broadcast.isWidgetizeRequestWithoutSession()?0:1}:{}}},{key:"mixinDefaultPostParams",value:function(e){var t=this.getDefaultPostParams(),n=Object.assign(Object.assign({},t),e);return n}},{key:"mixinDefaultGetParams",value:function(e){var t=this,n=De.getSearchParam("segment"),r={idSite:ue.idSite?ue.idSite.toString():broadcast.getValueFromUrl("idSite"),period:ue.period||broadcast.getValueFromUrl("period"),segment:n},o=e;return o.token_auth&&(o.token_auth=null,delete o.token_auth),Object.keys(r).forEach((function(e){!t.useGETDefaultParameter(e)||null!==o[e]&&"undefined"!==typeof o[e]&&""!==o[e]||null!==t.postParams[e]&&"undefined"!==typeof t.postParams[e]&&""!==t.postParams[e]||!r[e]||(o[e]=r[e])})),!this.useGETDefaultParameter("date")||o.date||this.postParams.date||(o.date=ue.currentDateString),o}},{key:"getRequestHandle",value:function(){return this.requestHandle}}],[{key:"fetch",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new e;n.withTokenInUrl&&r.withTokenInUrl(),n.errorElement&&r.setErrorElement(n.errorElement),n.redirectOnSuccess&&r.redirectOnSuccess(!0!==n.redirectOnSuccess?n.redirectOnSuccess:void 0),r.setFormat(n.format||"json"),Array.isArray(t)?r.setBulkRequests.apply(r,Te(t)):(Object.keys(t).forEach((function(e){if(/password/i.test(e))throw new Error("Password parameters are not allowed to be sent as GET parameter. Please send ".concat(e," as POST parameter instead."))})),r.addParams(Object.assign(Object.assign({module:"API",format:n.format||"json"},t),{},{segment:t.segment?encodeURIComponent(t.segment):void 0}),"get")),n.postParams&&r.addParams(n.postParams,"post"),n.headers&&(r.headers=Object.assign(Object.assign({},r.headers),n.headers));var o=!0;return"undefined"===typeof n.createErrorNotification||n.createErrorNotification||(r.useCallbackInCaseOfError(),r.setErrorCallback(null),o=!1),n.abortController&&(r.abortController=n.abortController),n.returnResponseObject&&(r.resolveWithHelper=!0),r.send().then((function(t){var n=t instanceof e?t.requestHandle.responseJSON:t,o="API.getBulkRequest"===r.postParams.method&&Array.isArray(n)?n:[n],a=o.filter((function(e){return"error"===e.result})).map((function(e){return e.message}));if(a.length)throw new Xe(a.filter((function(e){return e.length})).join("\n"));return t})).catch((function(e){if(o||e instanceof Xe)throw e;var t="Something went wrong";throw 504===e.status&&(t="Request was possibly aborted"),429===e.status&&(t="Rate Limit was exceed"),new Error(t)}))}},{key:"post",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.fetch(t,Object.assign(Object.assign({},r),{},{postParams:n}))}},{key:"oneAtATime",value:function(t,n){var r=null;return function(o,a){return r&&r.abort(),r=new AbortController,e.post(Object.assign(Object.assign({},o),{},{method:t}),a,Object.assign(Object.assign({},n),{},{abortController:r})).finally((function(){r=null}))}}}]),e}();function et(e,t){return at(e)||ot(e,t)||nt(e,t)||tt()}function tt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nt(e,t){if(e){if("string"===typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(e,t):void 0}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ot(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done);i=!0)if(a.push(r.value),t&&a.length===t)break}catch(c){l=!0,o=c}finally{try{i||null==n["return"]||n["return"]()}finally{if(l)throw o}}return a}}function at(e){if(Array.isArray(e))return e}function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ct(e,t,n){return t&&lt(e.prototype,t),n&&lt(e,n),e}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
+ */we.updatePeriodParamsFromUrl=Ee.updatePeriodParamsFromUrl.bind(Ee);var Je=window,Ke=Je.$;function Qe(e,t){"abort"!==t&&e&&0!==e.status&&("undefined"!==typeof Piwik_Popover?Piwik_Popover.isOpen()&&e&&500===e.status?Ke(document.body).html(piwikHelper.escape(e.responseText)):Ke("#loadingError").show():console.log("Request failed: ".concat(e.responseText)))}window.globalAjaxQueue=[],window.globalAjaxQueue.active=0,window.globalAjaxQueue.clean=function(){for(var e=this.length;e>=0;e-=1)this[e]&&4!==this[e].readyState||this.splice(e,1)},window.globalAjaxQueue.push=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this.active+=n.length,this.clean(),(e=Array.prototype.push).call.apply(e,[this].concat(n))},window.globalAjaxQueue.abort=function(){this.forEach((function(e){return e&&e.abort&&e.abort()})),this.splice(0,this.length),this.active=0};var Xe=function(e){_e(n,e);var t=Re(n);function n(){return Fe(this,n),t.apply(this,arguments)}return n}($e(Error)),Ze=function(){function e(){Fe(this,e),Le(this,"format","json"),Le(this,"timeout",null),Le(this,"callback",null),Le(this,"useRegularCallbackInCaseOfError",!1),Le(this,"errorCallback",void 0),Le(this,"withToken",!1),Le(this,"completeCallback",void 0),Le(this,"getParams",{}),Le(this,"getUrl","?"),Le(this,"postParams",{}),Le(this,"loadingElement",null),Le(this,"errorElement","#ajaxError"),Le(this,"headers",{"X-Requested-With":"XMLHttpRequest"}),Le(this,"requestHandle",null),Le(this,"abortController",null),Le(this,"abortable",!0),Le(this,"defaultParams",["idSite","period","date","segment"]),Le(this,"resolveWithHelper",!1),this.errorCallback=Qe}return Me(e,[{key:"addParams",value:function(e,t){var n=this,r="string"===typeof e?window.broadcast.getValuesFromUrl(e):e,o=["compareSegments","comparePeriods","compareDates"];Object.keys(r).forEach((function(e){var a=r[e];(-1===o.indexOf(e)||a)&&("boolean"===typeof a&&(a=a?1:0),"get"===t.toLowerCase()?n.getParams[e]=a:"post"===t.toLowerCase()&&(n.postParams[e]=a))}))}},{key:"withTokenInUrl",value:function(){this.withToken=!0}},{key:"setUrl",value:function(e){this.addParams(broadcast.getValuesFromUrl(e),"GET")}},{key:"setBulkRequests",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e){return"string"===typeof e?e:Ke.param(e)}));this.addParams({module:"API",method:"API.getBulkRequest",urls:r,format:"json"},"post")}},{key:"setTimeout",value:function(e){this.timeout=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"useCallbackInCaseOfError",value:function(){this.useRegularCallbackInCaseOfError=!0}},{key:"redirectOnSuccess",value:function(e){this.setCallback((function(){piwikHelper.redirect(e)}))}},{key:"setErrorCallback",value:function(e){this.errorCallback=e}},{key:"setCompleteCallback",value:function(e){this.completeCallback=e}},{key:"setFormat",value:function(e){this.format=e}},{key:"setLoadingElement",value:function(e){this.loadingElement=e||"#ajaxLoadingDiv"}},{key:"setErrorElement",value:function(e){e&&(this.errorElement=e)}},{key:"useGETDefaultParameter",value:function(e){if(e&&this.defaultParams)for(var t=0;t<this.defaultParams.length;t+=1)if(this.defaultParams[t]===e)return!0;return!1}},{key:"removeDefaultParameter",value:function(e){if(e&&this.defaultParams)for(var t=0;t<this.defaultParams.length;t+=1)this.defaultParams[t]===e&&this.defaultParams.splice(t,1)}},{key:"send",value:function(){var e=this;Ke(this.errorElement).length&&Ke(this.errorElement).hide(),this.loadingElement&&Ke(this.loadingElement).fadeIn(),this.requestHandle=this.buildAjaxCall(),this.abortable&&window.globalAjaxQueue.push(this.requestHandle),this.abortController&&this.abortController.signal.addEventListener("abort",(function(){e.requestHandle&&e.requestHandle.abort()}));var t=new Promise((function(t,n){e.requestHandle.then((function(n){e.resolveWithHelper?t(e):t(n)})).fail((function(t){if(429===t.status)return console.log("Warning: the '".concat(Ke.param(e.getParams),"' request was rate limited!")),void n(t);"abort"!==t.statusText&&0!==t.status&&(console.log("Warning: the ".concat(Ke.param(e.getParams)," request failed!")),n(t))}))}));return t}},{key:"abort",value:function(){this.requestHandle&&"function"===typeof this.requestHandle.abort&&(this.requestHandle.abort(),this.requestHandle=null)}},{key:"buildAjaxCall",value:function(){var e=this,t=this,n=this.mixinDefaultGetParams(this.getParams),r=this.getUrl;"?"!==r[r.length-1]&&(r+="&"),n.segment&&(r="".concat(r,"segment=").concat(n.segment,"&"),delete n.segment),n.date&&(r="".concat(r,"date=").concat(decodeURIComponent(n.date.toString()),"&"),delete n.date),r+=Ke.param(n);var o={type:"POST",async:!0,url:r,dataType:this.format||"json",complete:this.completeCallback,headers:this.headers?this.headers:void 0,error:function(){if(t.abortable&&(window.globalAjaxQueue.active-=1),t.errorCallback){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.errorCallback.apply(this,n)}},success:function(n,r,o){e.loadingElement&&Ke(e.loadingElement).hide();var a="API.getBulkRequest"===e.postParams.method&&Array.isArray(n)?n:[n],i=a.filter((function(e){return"error"===e.result})).map((function(e){return e.message})).filter((function(e){return e.length})).reduce((function(e,t){return e[t]=(e[t]||0)+1,e}),{});if(i&&Object.keys(i).length&&!e.useRegularCallbackInCaseOfError){var l="";Object.keys(i).forEach((function(e){l.length&&(l+="<br />"),i[e]>1?l+="".concat(e," (").concat(i[e],"x)"):l+=e}));var c=null,s="toast";Ke(e.errorElement).length&&l.length&&(Ke(e.errorElement).show(),c=e.errorElement,s=null);var u=!document.querySelector("#login_form");if(l&&u){var d=window["require"]("piwik/UI"),m=new d.Notification;m.show(l,{placeat:c,context:"error",type:s,id:"ajaxHelper"}),m.scrollToNotification()}}else e.callback&&e.callback(n,r,o);t.abortable&&(window.globalAjaxQueue.active-=1),ue.ajaxRequestFinished&&ue.ajaxRequestFinished()},data:this.mixinDefaultPostParams(this.postParams),timeout:null!==this.timeout?this.timeout:void 0};return Ke.ajax(o)}},{key:"isRequestToApiMethod",value:function(){return this.getParams&&"API"===this.getParams.module&&this.getParams.method||this.postParams&&"API"===this.postParams.module&&this.postParams.method}},{key:"isWidgetizedRequest",value:function(){return"Widgetize"===broadcast.getValueFromUrl("module")}},{key:"getDefaultPostParams",value:function(){return this.withToken||this.isRequestToApiMethod()||ue.shouldPropagateTokenAuth?{token_auth:ue.token_auth,force_api_session:broadcast.isWidgetizeRequestWithoutSession()?0:1}:{}}},{key:"mixinDefaultPostParams",value:function(e){var t=this.getDefaultPostParams(),n=Object.assign(Object.assign({},t),e);return n}},{key:"mixinDefaultGetParams",value:function(e){var t=this,n=De.getSearchParam("segment"),r={idSite:ue.idSite?ue.idSite.toString():broadcast.getValueFromUrl("idSite"),period:ue.period||broadcast.getValueFromUrl("period"),segment:n},o=e;return o.token_auth&&(o.token_auth=null,delete o.token_auth),Object.keys(r).forEach((function(e){!t.useGETDefaultParameter(e)||null!==o[e]&&"undefined"!==typeof o[e]&&""!==o[e]||null!==t.postParams[e]&&"undefined"!==typeof t.postParams[e]&&""!==t.postParams[e]||!r[e]||(o[e]=r[e])})),!this.useGETDefaultParameter("date")||o.date||this.postParams.date||(o.date=ue.currentDateString),o}},{key:"getRequestHandle",value:function(){return this.requestHandle}}],[{key:"fetch",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new e;n.withTokenInUrl&&r.withTokenInUrl(),n.errorElement&&r.setErrorElement(n.errorElement),n.redirectOnSuccess&&r.redirectOnSuccess(!0!==n.redirectOnSuccess?n.redirectOnSuccess:void 0),r.setFormat(n.format||"json"),Array.isArray(t)?r.setBulkRequests.apply(r,Te(t)):(Object.keys(t).forEach((function(e){if(/password/i.test(e))throw new Error("Password parameters are not allowed to be sent as GET parameter. Please send ".concat(e," as POST parameter instead."))})),r.addParams(Object.assign(Object.assign({module:"API",format:n.format||"json"},t),{},{segment:t.segment?encodeURIComponent(t.segment):void 0}),"get")),n.postParams&&r.addParams(n.postParams,"post"),n.headers&&(r.headers=Object.assign(Object.assign({},r.headers),n.headers));var o=!0;return"undefined"===typeof n.createErrorNotification||n.createErrorNotification||(r.useCallbackInCaseOfError(),r.setErrorCallback(null),o=!1),n.abortController&&(r.abortController=n.abortController),n.returnResponseObject&&(r.resolveWithHelper=!0),!1===n.abortable&&(r.abortable=!1),r.send().then((function(t){var n=t instanceof e?t.requestHandle.responseJSON:t,o="API.getBulkRequest"===r.postParams.method&&Array.isArray(n)?n:[n],a=o.filter((function(e){return"error"===e.result})).map((function(e){return e.message}));if(a.length)throw new Xe(a.filter((function(e){return e.length})).join("\n"));return t})).catch((function(e){if(o||e instanceof Xe)throw e;var t="Something went wrong";throw 504===e.status&&(t="Request was possibly aborted"),429===e.status&&(t="Rate Limit was exceed"),new Error(t)}))}},{key:"post",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.fetch(t,Object.assign(Object.assign({},r),{},{postParams:n}))}},{key:"oneAtATime",value:function(t,n){var r=null;return function(o,a){return r&&r.abort(),r=new AbortController,e.post(Object.assign(Object.assign({},o),{},{method:t}),a,Object.assign(Object.assign({},n),{},{abortController:r})).finally((function(){r=null}))}}}]),e}();function et(e,t){return at(e)||ot(e,t)||nt(e,t)||tt()}function tt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nt(e,t){if(e){if("string"===typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(e,t):void 0}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ot(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done);i=!0)if(a.push(r.value),t&&a.length===t)break}catch(c){l=!0,o=c}finally{try{i||null==n["return"]||n["return"]()}finally{if(l)throw o}}return a}}function at(e){if(Array.isArray(e))return e}function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ct(e,t,n){return t&&lt(e.prototype,t),n&&lt(e,n),e}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
 /*!
  * Matomo - free/libre analytics platform
  *
@@ -227,7 +227,7 @@ function _n(e){e.classList.add("expanded");var t=e.querySelector(".dropdown.posi
  *
  * @link    https://matomo.org
  * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
- */var Na=function(){function e(){var t=this;Da(this,e),Va(this,"state",Object(X["reactive"])({initialSites:[],isInitialized:!1})),Va(this,"stateFiltered",Object(X["reactive"])({initialSites:[],isInitialized:!1,excludedSites:[]})),Va(this,"currentRequestAbort",null),Va(this,"limitRequest",void 0),Va(this,"initialSites",Object(X["computed"])((function(){return Object(X["readonly"])(t.state.initialSites)}))),Va(this,"initialSitesFiltered",Object(X["computed"])((function(){return Object(X["readonly"])(t.stateFiltered.initialSites)})))}return Ta(e,[{key:"loadInitialSites",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.state.isInitialized&&0===n.length?Promise.resolve(Object(X["readonly"])(this.state.initialSites)):this.stateFiltered.isInitialized&&n.length===this.stateFiltered.excludedSites.length&&n.every((function(t,n){return t===e.stateFiltered.excludedSites[n]}))?Promise.resolve(Object(X["readonly"])(this.stateFiltered.initialSites)):(n.length>0&&this.searchSite("%",t,n).then((function(t){e.stateFiltered.isInitialized=!0,e.stateFiltered.excludedSites=n,null!==t&&(e.stateFiltered.initialSites=t)})),this.state.isInitialized?Promise.resolve(Object(X["readonly"])(this.state.initialSites)):this.searchSite("%",t,n).then((function(t){return e.state.isInitialized=!0,null!==t&&(e.state.initialSites=t),t})))}},{key:"loadSite",value:function(e){"all"===e?De.updateUrl(Object.assign(Object.assign({},De.urlParsed.value),{},{module:"MultiSites",action:"index",date:De.parsed.value.date,period:De.parsed.value.period})):De.updateUrl(Object.assign(Object.assign({},De.urlParsed.value),{},{segment:"",idSite:e}),Object.assign(Object.assign({},De.hashParsed.value),{},{segment:"",idSite:e}))}},{key:"searchSite",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e?(this.currentRequestAbort&&this.currentRequestAbort.abort(),this.limitRequest||(this.limitRequest=Ze.fetch({method:"SitesManager.getNumWebsitesToDisplayPerPage"})),this.limitRequest.then((function(o){var a=o.value,i="SitesManager.getPatternMatchSites";return n&&(i="SitesManager.getSitesWithAdminAccess"),t.currentRequestAbort=new AbortController,Ze.fetch({method:i,limit:a,pattern:e,sitesToExclude:r},{abortController:t.currentRequestAbort})})).then((function(e){return e?t.processWebsitesList(e):null})).finally((function(){t.currentRequestAbort=null}))):this.loadInitialSites(n,r)}},{key:"processWebsitesList",value:function(e){var t=e;return t&&t.length?(t=t.map((function(e){return Object.assign(Object.assign({},e),{},{name:e.group?"[".concat(e.group,"] ").concat(e.name):e.name})})),t.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0})),t):[]}}]),e}(),Ia=new Na,xa=["value","name"],Ba=["title"],Aa=["textContent"],Ma={key:1,class:"placeholder"},La={class:"dropdown"},Fa={class:"custom_select_search"},_a=["placeholder"],Ra={key:0},Ha={class:"custom_select_container"},Ua=["onClick"],$a=["innerHTML","href","title"],qa={class:"custom_select_ul_list"},Wa={class:"noresult"},za={key:1};function Ga(e,t,n,r,o,a){var i,l,c,s,u=Object(X["resolveComponent"])("AllSitesLink"),d=Object(X["resolveDirective"])("focus-if"),m=Object(X["resolveDirective"])("tooltips"),p=Object(X["resolveDirective"])("focus-anywhere-but-here");return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{class:Object(X["normalizeClass"])(["siteSelector piwikSelector borderedControl",{expanded:e.showSitesList,disabled:!e.hasMultipleSites}])},[e.name?(Object(X["openBlock"])(),Object(X["createElementBlock"])("input",{key:0,type:"hidden",value:null===(i=e.displayedModelValue)||void 0===i?void 0:i.id,name:e.name},null,8,xa)):Object(X["createCommentVNode"])("",!0),Object(X["createElementVNode"])("a",{ref:"selectorLink",onClick:t[0]||(t[0]=function(){return e.onClickSelector&&e.onClickSelector.apply(e,arguments)}),onKeydown:t[1]||(t[1]=function(t){return e.onPressEnter(t)}),href:"javascript:void(0)",class:Object(X["normalizeClass"])([{loading:e.isLoading},"title"]),tabindex:"4",title:e.selectorLinkTitle},[Object(X["createElementVNode"])("span",{class:Object(X["normalizeClass"])(["icon icon-chevron-down",{iconHidden:e.isLoading,collapsed:!e.showSitesList}])},null,2),Object(X["createElementVNode"])("span",null,[null!==(l=e.displayedModelValue)&&void 0!==l&&l.name||!e.placeholder?(Object(X["openBlock"])(),Object(X["createElementBlock"])("span",{key:0,textContent:Object(X["toDisplayString"])((null===(c=e.displayedModelValue)||void 0===c?void 0:c.name)||e.firstSiteName)},null,8,Aa)):Object(X["createCommentVNode"])("",!0),null!==(s=e.displayedModelValue)&&void 0!==s&&s.name||!e.placeholder?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("span",Ma,Object(X["toDisplayString"])(e.placeholder),1))])],42,Ba),Object(X["withDirectives"])(Object(X["createElementVNode"])("div",La,[Object(X["withDirectives"])(Object(X["createElementVNode"])("div",Fa,[Object(X["withDirectives"])(Object(X["createElementVNode"])("input",{type:"text",onClick:t[2]||(t[2]=function(t){e.searchTerm="",e.loadInitialSites()}),"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.searchTerm=t}),tabindex:"4",class:"websiteSearch inp browser-default",placeholder:e.translate("General_Search")},null,8,_a),[[X["vModelText"],e.searchTerm],[d,{focused:e.shouldFocusOnSearch}]]),Object(X["withDirectives"])(Object(X["createElementVNode"])("img",{title:"Clear",onClick:t[4]||(t[4]=function(t){e.searchTerm="",e.loadInitialSites()}),class:"reset",src:"plugins/CoreHome/images/reset_search.png"},null,512),[[X["vShow"],e.searchTerm]])],512),[[X["vShow"],e.autocompleteMinSites<=e.sites.length||e.searchTerm]]),"top"===e.allSitesLocation&&e.showAllSitesItem?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Ra,[Object(X["createVNode"])(u,{href:e.urlAllSites,"all-sites-text":e.allSitesText,onClick:t[5]||(t[5]=function(t){return e.onAllSitesClick(t)})},null,8,["href","all-sites-text"])])):Object(X["createCommentVNode"])("",!0),Object(X["withDirectives"])(Object(X["createElementVNode"])("div",Ha,[Object(X["createElementVNode"])("ul",{class:"custom_select_ul_list",onClick:t[7]||(t[7]=function(t){return e.showSitesList=!1})},[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.sites,(function(n,r){return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{onClick:function(t){return e.switchSite(Object.assign(Object.assign({},n),{},{id:n.idsite}),t)},key:r},[Object(X["createElementVNode"])("a",{onClick:t[6]||(t[6]=function(e){return e.preventDefault()}),innerHTML:e.$sanitize(e.getMatchedSiteName(n.name)),tabindex:"4",href:e.getUrlForSiteId(n.idsite),title:n.name},null,8,$a)],8,Ua)),[[X["vShow"],!(!e.showSelectedSite&&"".concat(e.activeSiteId)==="".concat(n.idsite))]])})),128))]),Object(X["withDirectives"])(Object(X["createElementVNode"])("ul",qa,[Object(X["createElementVNode"])("li",null,[Object(X["createElementVNode"])("div",Wa,Object(X["toDisplayString"])(e.translate("SitesManager_NotFound")+" "+e.searchTerm),1)])],512),[[X["vShow"],!e.sites.length&&e.searchTerm]])],512),[[m,{content:e.tooltipContent}]]),"bottom"===e.allSitesLocation&&e.showAllSitesItem?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",za,[Object(X["createVNode"])(u,{href:e.urlAllSites,"all-sites-text":e.allSitesText,onClick:t[8]||(t[8]=function(t){return e.onAllSitesClick(t)})},null,8,["href","all-sites-text"])])):Object(X["createCommentVNode"])("",!0)],512),[[X["vShow"],e.showSitesList]])],2)),[[p,{blur:e.onBlur}]])}var Ya=["innerHTML","href"];function Ja(e,t,n,r,o,a){var i=this;return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{onClick:t[1]||(t[1]=function(e){return i.onClick(e)}),class:"custom_select_all"},[Object(X["createElementVNode"])("a",{onClick:t[0]||(t[0]=function(e){return e.preventDefault()}),innerHTML:e.$sanitize(e.allSitesText),tabindex:"4",href:e.href},null,8,Ya)])}var Ka=Object(X["defineComponent"])({props:{href:String,allSitesText:String},emits:["click"],methods:{onClick:function(e){this.$emit("click",e)}}});Ka.render=Ja;var Qa=Ka,Xa=Object(X["defineComponent"])({props:{modelValue:Object,showSelectedSite:{type:Boolean,default:!1},showAllSitesItem:{type:Boolean,default:!0},switchSiteOnSelect:{type:Boolean,default:!0},onlySitesWithAdminAccess:{type:Boolean,default:!1},name:{type:String,default:""},allSitesText:{type:String,default:a("General_MultiSitesSummary")},allSitesLocation:{type:String,default:"bottom"},placeholder:String,defaultToFirstSite:Boolean,sitesToExclude:{type:Array,default:function(){return[]}}},emits:["update:modelValue","blur"],components:{AllSitesLink:Qa},directives:{FocusAnywhereButHere:gn,FocusIf:On,Tooltips:Cn},watch:{searchTerm:function(){this.onSearchTermChanged()}},data:function(){return{searchTerm:"",activeSiteId:"".concat(ue.idSite),showSitesList:!1,isLoading:!1,sites:[],autocompleteMinSites:parseInt(ue.config.autocomplete_min_sites,10)}},created:function(){this.searchSite=$t(this.searchSite),!this.modelValue&&ue.idSite&&this.$emit("update:modelValue",{id:ue.idSite,name:ue.helper.htmlDecode(ue.siteName)})},mounted:function(){var e=this;window.initTopControls(),this.loadInitialSites().then((function(){e.shouldDefaultToFirstSite&&e.$emit("update:modelValue",{id:e.sites[0].idsite,name:e.sites[0].name})}));var t=a("CoreHome_ShortcutWebsiteSelector");ue.helper.registerShortcut("w",t,(function(t){if(!t.altKey){t.preventDefault?t.preventDefault():t.returnValue=!1;var n=e.$refs.selectorLink;n&&(n.click(),n.focus())}}))},computed:{shouldFocusOnSearch:function(){return this.showSitesList&&this.autocompleteMinSites<=this.sites.length||this.searchTerm},selectorLinkTitle:function(){var e;return this.hasMultipleSites?a("CoreHome_ChangeCurrentWebsite",(null===(e=this.modelValue)||void 0===e?void 0:e.name)||this.firstSiteName):""},hasMultipleSites:function(){var e=Ia.initialSitesFiltered.value&&Ia.initialSitesFiltered.value.length?Ia.initialSitesFiltered.value:Ia.initialSites.value;return e&&e.length>1},firstSiteName:function(){var e=Ia.initialSitesFiltered.value&&Ia.initialSitesFiltered.value.length?Ia.initialSitesFiltered.value:Ia.initialSites.value;return e&&e.length>0?e[0].name:""},urlAllSites:function(){var e=De.stringify(Object.assign(Object.assign({},De.urlParsed.value),{},{module:"MultiSites",action:"index",date:De.parsed.value.date,period:De.parsed.value.period}));return"?".concat(e)},shouldDefaultToFirstSite:function(){var e;return!(null!==(e=this.modelValue)&&void 0!==e&&e.id)&&(!this.hasMultipleSites||this.defaultToFirstSite)&&this.sites[0]},displayedModelValue:function(){return this.modelValue?this.modelValue:ue.idSite?{id:ue.idSite,name:ue.helper.htmlDecode(ue.siteName)}:this.shouldDefaultToFirstSite?{id:this.sites[0].idsite,name:this.sites[0].name}:null},tooltipContent:function(){return function(){var e=$(this).attr("title")||"";return ue.helper.htmlEntities(e)}}},methods:{onSearchTermChanged:function(){this.searchTerm?(this.isLoading=!0,this.searchSite(this.searchTerm)):(this.isLoading=!1,this.loadInitialSites())},onAllSitesClick:function(e){this.switchSite({id:"all",name:this.$props.allSitesText},e),this.showSitesList=!1},switchSite:function(e,t){var n=-1!==navigator.userAgent.indexOf("Mac OS X")?t.metaKey:t.ctrlKey;t&&n&&t.target&&t.target.href?window.open(t.target.href,"_blank"):(this.$emit("update:modelValue",{id:e.id,name:e.name}),this.switchSiteOnSelect&&this.activeSiteId!==e.id&&Ia.loadSite(e.id))},onBlur:function(){this.showSitesList=!1,this.$emit("blur")},onClickSelector:function(){this.hasMultipleSites&&(this.showSitesList=!this.showSitesList,this.isLoading||this.searchTerm||this.loadInitialSites())},onPressEnter:function(e){"Enter"===e.key&&(e.preventDefault(),this.showSitesList=!this.showSitesList,this.showSitesList&&!this.isLoading&&this.loadInitialSites())},getMatchedSiteName:function(e){var t=e.toUpperCase().indexOf(this.searchTerm.toUpperCase());if(-1===t||this.isLoading)return this.htmlEntities(e);var n=this.htmlEntities(e.substring(0,t)),r=this.htmlEntities(e.substring(t+this.searchTerm.length));return"".concat(n,'<span class="autocompleteMatched">').concat(this.searchTerm,"</span>").concat(r)},loadInitialSites:function(){var e=this;return Ia.loadInitialSites(this.onlySitesWithAdminAccess,this.sitesToExclude?this.sitesToExclude:[]).then((function(t){e.sites=t||[]}))},searchSite:function(e){var t=this;this.isLoading=!0,Ia.searchSite(e,this.onlySitesWithAdminAccess,this.sitesToExclude?this.sitesToExclude:[]).then((function(n){e===t.searchTerm&&n&&(t.sites=n)})).finally((function(){t.isLoading=!1}))},getUrlForSiteId:function(e){var t=De.stringify(Object.assign(Object.assign({},De.urlParsed.value),{},{segment:"",idSite:e})),n=De.stringify(Object.assign(Object.assign({},De.hashParsed.value),{},{segment:"",idSite:e}));return"?".concat(t,"#?").concat(n)},htmlEntities:function(e){return ue.helper.htmlEntities(e)}}});Xa.render=Ga;var Za=Xa,ei={ref:"root",class:"quickAccessInside"},ti=["title","placeholder"],ni={class:"dropdown"},ri={class:"no-result"},oi=["onClick"],ai=["onMouseenter","onClick"],ii={class:"quickAccessMatomoSearch"},li=["onMouseenter","onClick"],ci=["textContent"],si={class:"quick-access-category helpCategory"},ui=["href"];function di(e,t,n,r,o,a){var i=Object(X["resolveDirective"])("focus-if"),l=Object(X["resolveDirective"])("focus-anywhere-but-here");return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("div",ei,[Object(X["createElementVNode"])("span",{class:"icon-search",onMouseenter:t[0]||(t[0]=function(t){return e.searchActive=!0})},null,32),Object(X["withDirectives"])(Object(X["createElementVNode"])("input",{class:"s",onKeydown:t[1]||(t[1]=function(t){return e.onKeypress(t)}),onFocus:t[2]||(t[2]=function(t){return e.searchActive=!0}),"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.searchTerm=t}),type:"text",tabindex:"2",title:e.quickAccessTitle,placeholder:e.translate("General_Search"),ref:"input"},null,40,ti),[[X["vModelText"],e.searchTerm],[i,{focused:e.searchActive}]]),Object(X["withDirectives"])(Object(X["createElementVNode"])("div",ni,[Object(X["withDirectives"])(Object(X["createElementVNode"])("ul",null,[Object(X["createElementVNode"])("li",ri,Object(X["toDisplayString"])(e.translate("General_SearchNoResults")),1)],512),[[X["vShow"],!(e.numMenuItems>0||e.sites.length)]]),(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.menuItems,(function(t){return Object(X["openBlock"])(),Object(X["createElementBlock"])("ul",{key:t.title},[Object(X["createElementVNode"])("li",{class:"quick-access-category",onClick:function(n){e.searchTerm=t.title,e.searchMenu(e.searchTerm)}},Object(X["toDisplayString"])(t.title),9,oi),(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(t.items,(function(t){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{class:Object(X["normalizeClass"])(["result",{selected:t.menuIndex===e.searchIndex}]),onMouseenter:function(n){return e.searchIndex=t.menuIndex},onClick:function(n){return e.selectMenuItem(t.index)},key:t.index},[Object(X["createElementVNode"])("a",null,Object(X["toDisplayString"])(t.name.trim()),1)],42,ai)})),128))])})),128)),Object(X["createElementVNode"])("ul",ii,[Object(X["withDirectives"])(Object(X["createElementVNode"])("li",{class:"quick-access-category websiteCategory"},Object(X["toDisplayString"])(e.translate("SitesManager_Sites")),513),[[X["vShow"],e.hasSitesSelector&&e.sites.length||e.isLoading]]),Object(X["withDirectives"])(Object(X["createElementVNode"])("li",{class:"no-result"},Object(X["toDisplayString"])(e.translate("MultiSites_LoadingWebsites")),513),[[X["vShow"],e.hasSitesSelector&&e.isLoading]]),(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.sites,(function(t,n){return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{class:Object(X["normalizeClass"])(["result",{selected:e.numMenuItems+n===e.searchIndex}]),onMouseenter:function(t){return e.searchIndex=e.numMenuItems+n},onClick:function(n){return e.selectSite(t.idsite)},key:t.idsite},[Object(X["createElementVNode"])("a",{textContent:Object(X["toDisplayString"])(t.name)},null,8,ci)],42,li)),[[X["vShow"],e.hasSitesSelector&&!e.isLoading]])})),128))]),Object(X["createElementVNode"])("ul",null,[Object(X["createElementVNode"])("li",si,Object(X["toDisplayString"])(e.translate("General_HelpResources")),1),Object(X["createElementVNode"])("li",{class:Object(X["normalizeClass"])([{selected:"help"===e.searchIndex},"quick-access-help"]),onMouseenter:t[4]||(t[4]=function(t){return e.searchIndex="help"})},[Object(X["createElementVNode"])("a",{href:"https://matomo.org?mtm_campaign=App_Help&mtm_source=Matomo_App&mtm_keyword=QuickSearch&s=".concat(encodeURIComponent(e.searchTerm)),target:"_blank"},Object(X["toDisplayString"])(e.translate("CoreHome_SearchOnMatomo",e.searchTerm)),9,ui)],34)])],512),[[X["vShow"],e.searchTerm&&e.searchActive]])],512)),[[l,{blur:e.onBlur}]])}var mi=window,pi=mi.ListingFormatter;function fi(e){var t=e.getBoundingClientRect(),n=window.$(window);return t.top>=0&&t.left>=0&&t.bottom<=n.height()&&t.right<=n.width()}function hi(e){e&&e.scrollIntoView&&e.scrollIntoView()}var bi=Object(X["defineComponent"])({directives:{FocusAnywhereButHere:gn,FocusIf:On},watch:{searchActive:function(e){var t=this.$refs.root;if(t&&t.parentElement){var n=t.parentElement.classList;n.toggle("active",e),n.toggle("expanded",e)}}},mounted:function(){var e=this,t=this.$refs.root;t&&t.parentElement&&t.parentElement.classList.add("quick-access","piwikSelector"),"undefined"!==typeof window.initTopControls&&window.initTopControls&&window.initTopControls(),ue.helper.registerShortcut("f",a("CoreHome_ShortcutSearch"),(function(t){t.altKey||(t.preventDefault(),hi(e.$refs.root),e.activateSearch())}))},data:function(){var e=!!document.querySelector(".segmentEditorPanel");return{menuItems:[],numMenuItems:0,searchActive:!1,searchTerm:"",searchIndex:0,menuIndexCounter:-1,topMenuItems:null,leftMenuItems:null,segmentItems:null,hasSegmentSelector:e,sites:[],isLoading:!1}},created:function(){this.searchMenu=$t(this.searchMenu.bind(this))},computed:{hasSitesSelector:function(){return!!document.querySelector('.top_controls .siteSelector,.top_controls [vue-entry="CoreHome.SiteSelector"]')},quickAccessTitle:function(){var e=[a("CoreHome_MenuEntries")];return this.hasSegmentSelector&&e.push(a("CoreHome_Segments")),this.hasSitesSelector&&e.push(a("SitesManager_Sites")),a("CoreHome_QuickAccessTitle",pi.formatAnd(e))}},emits:["itemSelected","blur"],methods:{onKeypress:function(e){var t=this,n=this.searchTerm&&this.searchActive,r=9===e.which,o=27===e.which;38===e.which?(this.highlightPreviousItem(),e.preventDefault()):40===e.which?(this.highlightNextItem(),e.preventDefault()):13===e.which?this.clickQuickAccessMenuItem():r&&n||o&&n?this.deactivateSearch():setTimeout((function(){t.searchActive=!0,t.searchMenu(t.searchTerm)}))},highlightPreviousItem:function(){this.searchIndex-1<0?this.searchIndex=0:this.searchIndex-=1,this.makeSureSelectedItemIsInViewport()},highlightNextItem:function(){var e=this.$refs.root.querySelectorAll("li.result").length;e<=this.searchIndex+1?this.searchIndex=e-1:this.searchIndex+=1,this.makeSureSelectedItemIsInViewport()},clickQuickAccessMenuItem:function(){var e=this,t=this.getCurrentlySelectedElement();t&&setTimeout((function(){t.click(),e.$emit("itemSelected",t)}),20)},deactivateSearch:function(){this.searchTerm="",this.searchActive=!1,this.$refs.input&&this.$refs.input.blur()},makeSureSelectedItemIsInViewport:function(){var e=this.getCurrentlySelectedElement();e&&!fi(e)&&hi(e)},getCurrentlySelectedElement:function(){var e=this.$refs.root.querySelectorAll("li.result");if(e&&e.length&&e.item(this.searchIndex))return e.item(this.searchIndex)},searchMenu:function(e){var t=this,n=e.toLowerCase(),r=-1,o={},a=[],i=function(e){var t=Object.assign({},e);r+=1,t.menuIndex=r;var n=t.category;n in o||(a.push({title:n,items:[]}),o[n]=a.length-1);var i=o[n];a[i].items.push(t)};this.resetSearchIndex(),this.hasSitesSelector&&(this.isLoading=!0,Ia.searchSite(n).then((function(e){e&&(t.sites=e)})).finally((function(){t.isLoading=!1})));var l=function(e){return-1!==e.name.toLowerCase().indexOf(n)||-1!==e.category.toLowerCase().indexOf(n)};null===this.topMenuItems&&(this.topMenuItems=this.getTopMenuItems()),null===this.leftMenuItems&&(this.leftMenuItems=this.getLeftMenuItems()),null===this.segmentItems&&(this.segmentItems=this.getSegmentItems());var c=this.topMenuItems.filter(l),s=this.leftMenuItems.filter(l),u=this.segmentItems.filter(l);c.forEach(i),s.forEach(i),u.forEach(i),this.numMenuItems=c.length+s.length+u.length,this.menuItems=a},resetSearchIndex:function(){this.searchIndex=0,this.makeSureSelectedItemIsInViewport()},selectSite:function(e){Ia.loadSite(e)},selectMenuItem:function(e){var t=document.querySelector("[quick_access='".concat(e,"']"));if(t){this.deactivateSearch();var n=t.getAttribute("href");if(n&&n.length>10&&t&&t.click)try{t.click()}catch(r){window.$(t).click()}else window.$(t).click()}},onBlur:function(){this.searchActive=!1,this.$emit("blur")},activateSearch:function(){this.searchActive=!0},getTopMenuItems:function(){var e=this,t=a("CoreHome_Menu"),n=[];return document.querySelectorAll("nav .sidenav li > a, nav .sidenav li > div > a").forEach((function(r){var o,a,i=null===(o=r.textContent)||void 0===o?void 0:o.trim();(!i||null!=r.parentElement&&null!=r.parentElement.tagName&&"DIV"===r.parentElement.tagName)&&(i=null===(a=r.getAttribute("title"))||void 0===a?void 0:a.trim());i&&(n.push({name:i,index:e.menuIndexCounter+=1,category:t}),r.setAttribute("quick_access","".concat(e.menuIndexCounter)))})),n},getLeftMenuItems:function(){var e=this,t=[];return document.querySelectorAll("#secondNavBar .menuTab").forEach((function(n){var r,o=window.$(n).find("> .item"),a=(null===(r=o[0])||void 0===r?void 0:r.innerText.trim())||"";a&&-1!==a.lastIndexOf("\n")&&(a=a.slice(0,a.lastIndexOf("\n")).trim()),window.$(n).find("li .item").each((function(n,r){var o,i=null===(o=r.textContent)||void 0===o?void 0:o.trim();i&&(t.push({name:i,category:a,index:e.menuIndexCounter+=1}),r.setAttribute("quick_access","".concat(e.menuIndexCounter)))}))})),t},getSegmentItems:function(){var e=this;if(!this.hasSegmentSelector)return[];var t=a("CoreHome_Segments"),n=[];return document.querySelectorAll(".segmentList [data-idsegment]").forEach((function(r){var o,a,i=null===(o=r.querySelector(".segname"))||void 0===o||null===(a=o.textContent)||void 0===a?void 0:a.trim();i&&(n.push({name:i,category:t,index:e.menuIndexCounter+=1}),r.setAttribute("quick_access","".concat(e.menuIndexCounter)))})),n}}});bi.render=di;var vi=bi;function gi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yi={class:"fieldArray form-group"},Oi={key:0,class:"fieldUiControl"},ji=["onClick","title"];function wi(e,t,n,r,o,a){var i=Object(X["resolveComponent"])("Field");return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",yi,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.modelValue,(function(t,n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{class:Object(X["normalizeClass"])(["fieldArrayTable multiple valign-wrapper",gi({},"fieldArrayTable".concat(n),!0)]),key:n},[e.field.uiControl?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Oi,[Object(X["createVNode"])(i,{"full-width":!0,"model-value":t,options:e.field.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(t,n)},"model-modifiers":e.field.modelModifiers,placeholder:" ",uicontrol:e.field.uiControl,title:e.field.title,name:"".concat(e.name,"-").concat(n),"template-file":e.field.templateFile,component:e.field.component},null,8,["model-value","options","onUpdate:modelValue","model-modifiers","uicontrol","title","name","template-file","component"])])):Object(X["createCommentVNode"])("",!0),Object(X["withDirectives"])(Object(X["createElementVNode"])("span",{onClick:function(t){return e.removeEntry(n)},class:"icon-minus valign",title:e.translate("General_Remove")},null,8,ji),[[X["vShow"],n+1!==e.modelValue.length]])],2)})),128))])}function ki(e){return Di(e)||Ei(e)||Ci(e)||Si()}function Si(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ci(e,t){if(e){if("string"===typeof e)return Pi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pi(e,t):void 0}}function Ei(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Di(e){if(Array.isArray(e))return Pi(e)}function Pi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ti=_t("CorePluginsAdmin","Field"),Vi=Object(X["defineComponent"])({props:{modelValue:Array,name:String,field:Object,rows:String},components:{Field:Ti},emits:["update:modelValue"],watch:{modelValue:function(e){this.checkEmptyModelValue(e)}},mounted:function(){this.checkEmptyModelValue(this.modelValue)},methods:{checkEmptyModelValue:function(e){e&&e.length&&""===e.slice(-1)[0]||this.rows&&!((this.modelValue||[]).length<parseInt(this.rows,10))||this.$emit("update:modelValue",[].concat(ki(e||[]),[""]))},onEntryChange:function(e,t){var n=ki(this.modelValue||[]);n[t]=e,this.$emit("update:modelValue",n)},removeEntry:function(e){if(e>-1&&this.modelValue){var t=this.modelValue.filter((function(t,n){return n!==e}));this.$emit("update:modelValue",t)}}}});Vi.render=wi;var Ni=Vi;function Ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xi={class:"multiPairField form-group"},Bi={key:1,class:"fieldUiControl fieldUiControl2"},Ai={key:2,class:"fieldUiControl fieldUiControl3"},Mi={key:3,class:"fieldUiControl fieldUiControl4"},Li=["onClick","title"];function Fi(e,t,n,r,o,a){var i=Object(X["resolveComponent"])("Field");return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",xi,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.modelValue,(function(t,n){var r;return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{class:Object(X["normalizeClass"])(["multiPairFieldTable multiple valign-wrapper",(r={},Ii(r,"multiPairFieldTable".concat(n),!0),Ii(r,"has".concat(e.fieldCount,"Fields"),!0),r)]),key:n},[e.field1?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{key:0,class:Object(X["normalizeClass"])(["fieldUiControl fieldUiControl1",{hasMultiFields:e.field1.type&&e.field2.type}])},[Object(X["createVNode"])(i,{"full-width":!0,"model-value":t[e.field1.key],options:e.field1.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(n,e.field1.key,t)},"model-modifiers":e.field1.modelModifiers,placeholder:" ",uicontrol:e.field1.uiControl,name:"".concat(e.name,"-p1-").concat(n),title:e.field1.title,"template-file":e.field1.templateFile,component:e.field1.component},null,8,["model-value","options","onUpdate:modelValue","model-modifiers","uicontrol","name","title","template-file","component"])],2)):Object(X["createCommentVNode"])("",!0),e.field2?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Bi,[Object(X["createVNode"])(i,{"full-width":!0,options:e.field2.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(n,e.field2.key,t)},"model-value":t[e.field2.key],"model-modifiers":e.field2.modelModifiers,placeholder:" ",uicontrol:e.field2.uiControl,name:"".concat(e.name,"-p2-").concat(n),title:e.field2.title,"template-file":e.field2.templateFile,component:e.field2.component},null,8,["options","onUpdate:modelValue","model-value","model-modifiers","uicontrol","name","title","template-file","component"])])):Object(X["createCommentVNode"])("",!0),e.field3?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Ai,[Object(X["createVNode"])(i,{"full-width":!0,options:e.field3.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(n,e.field3.key,t)},"model-value":t[e.field3.key],"model-modifiers":e.field3.modelModifiers,placeholder:" ",uicontrol:e.field3.uiControl,title:e.field3.title,"template-file":e.field3.templateFile,component:e.field3.component},null,8,["options","onUpdate:modelValue","model-value","model-modifiers","uicontrol","title","template-file","component"])])):Object(X["createCommentVNode"])("",!0),e.field4?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Mi,[Object(X["createVNode"])(i,{"full-width":!0,options:e.field4.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(n,e.field4.key,t)},"model-value":t[e.field4.key],"model-modifiers":e.field4.modelModifiers,placeholder:" ",uicontrol:e.field4.uiControl,title:e.field4.title,"template-file":e.field4.templateFile,component:e.field4.component},null,8,["options","onUpdate:modelValue","model-value","model-modifiers","uicontrol","title","template-file","component"])])):Object(X["createCommentVNode"])("",!0),Object(X["withDirectives"])(Object(X["createElementVNode"])("span",{onClick:function(t){return e.removeEntry(n)},class:"icon-minus valign",title:e.translate("General_Remove")},null,8,Li),[[X["vShow"],n+1!==e.modelValue.length]])],2)})),128))])}function _i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ri(e){return qi(e)||$i(e)||Ui(e)||Hi()}function Hi(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ui(e,t){if(e){if("string"===typeof e)return Wi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wi(e,t):void 0}}function $i(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function qi(e){if(Array.isArray(e))return Wi(e)}function Wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zi=_t("CorePluginsAdmin","Field"),Gi=Object(X["defineComponent"])({props:{modelValue:Array,name:String,field1:Object,field2:Object,field3:Object,field4:Object,rows:Number},components:{Field:zi},computed:{fieldCount:function(){return this.field1&&this.field2&&this.field3&&this.field4?4:this.field1&&this.field2&&this.field3?3:this.field1&&this.field2?2:this.field1?1:0}},emits:["update:modelValue"],watch:{modelValue:function(e){this.checkEmptyModelValue(e)}},mounted:function(){this.checkEmptyModelValue(this.modelValue)},methods:{checkEmptyModelValue:function(e){e&&e.length&&!this.isEmptyValue(e.slice(-1)[0])||this.rows&&!(this.modelValue.length<this.rows)||this.$emit("update:modelValue",[].concat(Ri(e||[]),[this.makeEmptyValue()]))},onEntryChange:function(e,t,n){var r=Ri(this.modelValue);r[e]=Object.assign(Object.assign({},r[e]),{},_i({},t,n)),this.$emit("update:modelValue",r)},removeEntry:function(e){if(e>-1&&this.modelValue){var t=this.modelValue.filter((function(t,n){return n!==e}));this.$emit("update:modelValue",t)}},isEmptyValue:function(e){var t=this.fieldCount;if(4===t){if(!e[this.field1.key]&&!e[this.field2.key]&&!e[this.field3.key]&&!e[this.field4.key])return!1}else if(3===t){if(!e[this.field1.key]&&!e[this.field2.key]&&!e[this.field3.key])return!1}else if(2===t){if(!e[this.field1.key]&&!e[this.field2.key])return!1}else if(1===t&&!e[this.field1.key])return!1;return!0},makeEmptyValue:function(){var e={};return this.field1&&this.field1.key&&(e[this.field1.key]=""),this.field2&&this.field2.key&&(e[this.field2.key]=""),this.field3&&this.field3.key&&(e[this.field3.key]=""),this.field4&&this.field4.key&&(e[this.field4.key]=""),e}}});Gi.render=Fi;var Yi=Gi,Ji=["disabled"],Ki=Object(X["createElementVNode"])("span",{class:"icon-chevron-left"},null,-1),Qi=[Ki],Xi=["title"],Zi=Object(X["createElementVNode"])("span",{class:"icon icon-calendar"},null,-1),el={id:"periodMore",class:"dropdown"},tl={class:"flex"},nl={key:0,class:"period-date"},rl={class:"period-type"},ol={id:"otherPeriods"},al=["onDblclick","title"],il=["id","checked","onChange","onDblclick"],ll={key:0,class:"compare-checkbox"},cl={id:"comparePeriodToDropdown"},sl={key:1,class:"compare-date-range"},ul={id:"comparePeriodStartDate"},dl=Object(X["createElementVNode"])("span",{class:"compare-dates-separator"},null,-1),ml={id:"comparePeriodEndDate"},pl={class:"apply-button-container"},fl=["disabled","value"],hl={key:2,id:"ajaxLoadingCalendar"},bl={class:"loadingSegment"},vl=["disabled"],gl=Object(X["createElementVNode"])("span",{class:"icon-chevron-right"},null,-1),yl=[gl];function Ol(e,t,n,r,o,a){var i=Object(X["resolveComponent"])("DateRangePicker"),l=Object(X["resolveComponent"])("PeriodDatePicker"),c=Object(X["resolveComponent"])("Field"),s=Object(X["resolveComponent"])("ActivityIndicator"),u=Object(X["resolveDirective"])("expand-on-click");return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{ref:"root",class:Object(X["normalizeClass"])(["periodSelector piwikSelector",{"periodSelector-withPrevNext":e.canShowMovePeriod}])},[e.canShowMovePeriod?(Object(X["openBlock"])(),Object(X["createElementBlock"])("button",{key:0,class:"move-period move-period-prev",onClick:t[0]||(t[0]=function(t){return e.movePeriod(-1)}),disabled:e.isPeriodMoveDisabled(-1)},Qi,8,Ji)):Object(X["createCommentVNode"])("",!0),Object(X["createElementVNode"])("a",{ref:"title",id:"date",class:"title",tabindex:"-1",title:e.translate("General_ChooseDate",e.currentlyViewingText)},[Zi,Object(X["createTextVNode"])(" "+Object(X["toDisplayString"])(e.currentlyViewingText),1)],8,Xi),Object(X["createElementVNode"])("div",el,[Object(X["createElementVNode"])("div",tl,[Object(X["createElementVNode"])("div",null,[Object(X["withDirectives"])(Object(X["createVNode"])(i,{class:"period-range","start-date":e.startRangeDate,"end-date":e.endRangeDate,onRangeChange:t[1]||(t[1]=function(t){return e.onRangeChange(t.start,t.end)}),onSubmit:t[2]||(t[2]=function(t){return e.onApplyClicked()})},null,8,["start-date","end-date"]),[[X["vShow"],"range"===e.selectedPeriod]]),"range"!==e.selectedPeriod?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",nl,[Object(X["createVNode"])(l,{id:"datepicker",period:e.selectedPeriod,date:e.periodValue===e.selectedPeriod?e.dateValue:null,onSelect:t[3]||(t[3]=function(t){return e.setPiwikPeriodAndDate(e.selectedPeriod,t.date)})},null,8,["period","date"])])):Object(X["createCommentVNode"])("",!0)]),Object(X["createElementVNode"])("div",rl,[Object(X["createElementVNode"])("h6",null,Object(X["toDisplayString"])(e.translate("General_Period")),1),Object(X["createElementVNode"])("div",ol,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.periodsFiltered,(function(n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("p",{key:n},[Object(X["createElementVNode"])("label",{class:Object(X["normalizeClass"])({"selected-period-label":n===e.selectedPeriod}),onDblclick:function(t){return e.changeViewedPeriod(n)},title:n===e.periodValue?"":e.translate("General_DoubleClickToChangePeriod")},[Object(X["withDirectives"])(Object(X["createElementVNode"])("input",{type:"radio",name:"period",id:"period_id_".concat(n),"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.selectedPeriod=t}),checked:e.selectedPeriod===n,onChange:function(t){return e.selectedPeriod=n},onDblclick:function(t){return e.changeViewedPeriod(n)}},null,40,il),[[X["vModelRadio"],e.selectedPeriod]]),Object(X["createElementVNode"])("span",null,Object(X["toDisplayString"])(e.getPeriodDisplayText(n)),1)],42,al)])})),128))])])]),e.isComparisonEnabled?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",ll,[Object(X["createElementVNode"])("label",null,[Object(X["withDirectives"])(Object(X["createElementVNode"])("input",{id:"comparePeriodTo",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.isComparing=t})},null,512),[[X["vModelCheckbox"],e.isComparing]]),Object(X["createElementVNode"])("span",null,Object(X["toDisplayString"])(e.translate("General_CompareTo")),1)]),Object(X["createElementVNode"])("div",cl,[Object(X["createVNode"])(c,{modelValue:e.comparePeriodType,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.comparePeriodType=t}),style:Object(X["normalizeStyle"])({visibility:e.isComparing?"visible":"hidden"}),name:"comparePeriodToDropdown",uicontrol:"select",options:e.comparePeriodDropdownOptions,"full-width":!0,disabled:!e.isComparing},null,8,["modelValue","style","options","disabled"])])])):Object(X["createCommentVNode"])("",!0),e.isComparing&&"custom"===e.comparePeriodType?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",sl,[Object(X["createElementVNode"])("div",null,[Object(X["createElementVNode"])("div",ul,[Object(X["createElementVNode"])("div",null,[Object(X["createVNode"])(c,{modelValue:e.compareStartDate,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.compareStartDate=t}),name:"comparePeriodStartDate",uicontrol:"text","full-width":!0,title:e.translate("CoreHome_StartDate"),placeholder:"YYYY-MM-DD"},null,8,["modelValue","title"])])]),dl,Object(X["createElementVNode"])("div",ml,[Object(X["createElementVNode"])("div",null,[Object(X["createVNode"])(c,{modelValue:e.compareEndDate,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.compareEndDate=t}),name:"comparePeriodEndDate",uicontrol:"text","full-width":!0,title:e.translate("CoreHome_EndDate"),placeholder:"YYYY-MM-DD"},null,8,["modelValue","title"])])])])])):Object(X["createCommentVNode"])("",!0),Object(X["createElementVNode"])("div",pl,[Object(X["createElementVNode"])("input",{type:"submit",id:"calendarApply",class:"btn",onClick:t[9]||(t[9]=function(t){return e.onApplyClicked()}),disabled:!e.isApplyEnabled(),value:e.translate("General_Apply")},null,8,fl)]),e.isLoadingNewPage?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",hl,[Object(X["createVNode"])(s,{loading:!0}),Object(X["createElementVNode"])("div",bl,Object(X["toDisplayString"])(e.translate("SegmentEditor_LoadingSegmentedDataMayTakeSomeTime")),1)])):Object(X["createCommentVNode"])("",!0)]),e.canShowMovePeriod?(Object(X["openBlock"])(),Object(X["createElementBlock"])("button",{key:1,class:"move-period move-period-next",onClick:t[10]||(t[10]=function(t){return e.movePeriod(1)}),disabled:e.isPeriodMoveDisabled(1)},yl,8,vl)):Object(X["createCommentVNode"])("",!0)],2)),[[u,{expander:"title"}]])}function jl(e,t){return El(e)||Cl(e,t)||kl(e,t)||wl()}function wl(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kl(e,t){if(e){if("string"===typeof e)return Sl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sl(e,t):void 0}}function Sl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cl(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done);i=!0)if(a.push(r.value),t&&a.length===t)break}catch(c){l=!0,o=c}finally{try{i||null==n["return"]||n["return"]()}finally{if(l)throw o}}return a}}function El(e){if(Array.isArray(e))return e}var Dl=_t("CorePluginsAdmin","Field"),Pl=ue.helper.htmlDecode("&nbsp;"),Tl=["custom","previousPeriod","previousYear"],Vl=[{key:"custom",value:a("General_Custom")},{key:"previousPeriod",value:a("General_PreviousPeriod").replace(/\s+/,Pl)},{key:"previousYear",value:a("General_PreviousYear").replace(/\s+/,Pl)}],Nl=new Date(ue.minDateYear,ue.minDateMonth-1,ue.minDateDay),Il=new Date(ue.maxDateYear,ue.maxDateMonth-1,ue.maxDateDay);function xl(e){return"[object Date]"===Object.prototype.toString.call(e)&&!Number.isNaN(e.getTime())}var Bl=Object(X["defineComponent"])({props:{periods:Array},components:{DateRangePicker:qo,PeriodDatePicker:Jo,Field:Dl,ActivityIndicator:ln},directives:{ExpandOnClick:Fn},data:function(){var e=De.parsed.value.period;return{comparePeriodDropdownOptions:Vl,periodValue:e,dateValue:null,selectedPeriod:e,startRangeDate:null,endRangeDate:null,isRangeValid:null,isLoadingNewPage:!1,isComparing:null,comparePeriodType:"previousPeriod",compareStartDate:"",compareEndDate:""}},mounted:function(){var e=this;ue.on("hidePeriodSelector",(function(){window.$(e.$refs.root).parent("#periodString").hide()})),ue.on("matomoPageChange",(function(){window.$(e.$refs.root).parent("#periodString").show()})),this.isComparing=fo.isComparingPeriods(),Object(X["watch"])((function(){return fo.isComparingPeriods()}),(function(t){e.isComparing=t})),this.updateSelectedValuesFromHash(),Object(X["watch"])((function(){return De.parsed.value}),this.updateSelectedValuesFromHash),this.updateComparisonValuesFromStore(),Object(X["watch"])((function(){return fo.getPeriodComparisons()}),this.updateComparisonValuesFromStore),window.initTopControls(),this.handleZIndexPositionRelativeCompareDropdownIssue()},computed:{currentlyViewingText:function(){var e;if("range"===this.periodValue){if(!this.startRangeDate||!this.endRangeDate)return a("General_Error");e="".concat(this.startRangeDate,",").concat(this.endRangeDate)}else{if(!this.dateValue)return a("General_Error");e=p(this.dateValue)}try{return m.parse(this.periodValue,e).getPrettyString()}catch(t){return a("General_Error")}},isComparisonEnabled:function(){return fo.isComparisonEnabled()},periodsFiltered:function(){return(this.periods||[]).filter((function(e){return m.isRecognizedPeriod(e)}))},selectedComparisonParams:function(){if(!this.isComparing)return{};if("custom"===this.comparePeriodType)return{comparePeriods:["range"],comparePeriodType:"custom",compareDates:["".concat(this.compareStartDate,",").concat(this.compareEndDate)]};if("previousPeriod"===this.comparePeriodType)return{comparePeriods:[this.selectedPeriod],comparePeriodType:"previousPeriod",compareDates:[this.previousPeriodDateToSelectedPeriod]};if("previousYear"===this.comparePeriodType){var e="range"===this.selectedPeriod?"".concat(this.startRangeDate,",").concat(this.endRangeDate):p(this.dateValue),t=m.parse(this.selectedPeriod,e).getDateRange();return t[0].setFullYear(t[0].getFullYear()-1),t[1].setFullYear(t[1].getFullYear()-1),"range"===this.selectedPeriod?{comparePeriods:["range"],comparePeriodType:"previousYear",compareDates:["".concat(p(t[0]),",").concat(p(t[1]))]}:{comparePeriods:[this.selectedPeriod],comparePeriodType:"previousYear",compareDates:[p(t[0])]}}return console.warn("Unknown compare period type: ".concat(this.comparePeriodType)),{}},previousPeriodDateToSelectedPeriod:function(){if("range"===this.selectedPeriod){var e=h(this.startRangeDate),t=h(this.endRangeDate),n=K.getLastNRange("day",2,e).startDate,r=Math.floor((t.valueOf()-e.valueOf())/864e5),o=K.getLastNRange("day",1+r,n);return"".concat(p(o.startDate),",").concat(p(o.endDate))}var a=K.getLastNRange(this.selectedPeriod,2,this.dateValue).startDate;return p(a)},selectedDateString:function(){if("range"===this.selectedPeriod){var e=this.startRangeDate,t=this.endRangeDate,n=h(e),r=h(t);return!xl(n)||!xl(r)||n>r?(window.$("#alert").find("h2").text(a("General_InvalidDateRange")),ue.helper.modalConfirm("#alert",{}),null):"".concat(e,",").concat(t)}return p(this.dateValue)},isErrorDisplayed:function(){return this.currentlyViewingText===a("General_Error")},isRangeSelection:function(){return"range"===this.periodValue},canShowMovePeriod:function(){return!this.isRangeSelection&&!this.isErrorDisplayed}},methods:{handleZIndexPositionRelativeCompareDropdownIssue:function(){var e=window.$(this.$refs.root);e.on("focus","#comparePeriodToDropdown .select-dropdown",(function(){e.addClass("compare-dropdown-open")})).on("blur","#comparePeriodToDropdown .select-dropdown",(function(){e.removeClass("compare-dropdown-open")}))},changeViewedPeriod:function(e){e!==this.periodValue&&"range"!==e&&this.setPiwikPeriodAndDate(e,this.dateValue)},setPiwikPeriodAndDate:function(e,t){this.periodValue=e,this.selectedPeriod=e,this.dateValue=t;var n=p(t);this.setRangeStartEndFromPeriod(e,n),this.propagateNewUrlParams(n,this.selectedPeriod),window.initTopControls()},propagateNewUrlParams:function(e,t){var n,r=this.selectedComparisonParams;ue.helper.isReportingPage()?(this.closePeriodSelector(),n=De.hashParsed.value):(this.isLoadingNewPage=!0,n=De.parsed.value);var o=Object.assign({},n);delete o.comparePeriods,delete o.comparePeriodType,delete o.compareDates,De.updateLocation(Object.assign(Object.assign({},o),{},{date:e,period:t},r))},onApplyClicked:function(){if("range"===this.selectedPeriod){var e=this.selectedDateString;if(!e)return;return this.periodValue="range",void this.propagateNewUrlParams(e,"range")}this.setPiwikPeriodAndDate(this.selectedPeriod,this.dateValue)},updateComparisonValuesFromStore:function(){this.comparePeriodType="previousPeriod",this.compareStartDate="",this.compareEndDate="";var e=fo.getPeriodComparisons();if(!(e.length<2)){var t=De.parsed.value.comparePeriodType;if(Tl.includes(t)&&(this.comparePeriodType=t,"custom"===this.comparePeriodType&&"range"===e[1].params.period)){var n;try{n=m.parse(e[1].params.period,e[1].params.date)}catch(l){return}var r=n.getDateRange(),o=jl(r,2),a=o[0],i=o[1];this.compareStartDate=p(a),this.compareEndDate=p(i)}}},updateSelectedValuesFromHash:function(){var e=De.parsed.value.date,t=De.parsed.value.period;this.periodValue=t,this.selectedPeriod=t,this.dateValue=null,this.startRangeDate=null,this.endRangeDate=null;try{m.parse(t,e)}catch(l){return}if("range"===t){var n=m.get(t).parse(e),r=n.getDateRange(),o=jl(r,2),a=o[0],i=o[1];this.dateValue=a,this.startRangeDate=p(a),this.endRangeDate=p(i)}else this.dateValue=h(e),this.setRangeStartEndFromPeriod(t,e)},setRangeStartEndFromPeriod:function(e,t){var n=m.parse(e,t).getDateRange();this.startRangeDate=p(n[0]<Nl?Nl:n[0]),this.endRangeDate=p(n[1]>Il?Il:n[1])},getPeriodDisplayText:function(e){return m.get(e).getDisplayText()},onRangeChange:function(e,t){e&&t?(this.isRangeValid=!0,this.startRangeDate=e,this.endRangeDate=t):this.isRangeValid=!1},isApplyEnabled:function(){return!("range"===this.selectedPeriod&&!this.isRangeValid)&&!(this.isComparing&&"custom"===this.comparePeriodType&&!this.isCompareRangeValid())},closePeriodSelector:function(){this.$refs.root.classList.remove("expanded")},isCompareRangeValid:function(){try{h(this.compareStartDate)}catch(e){return!1}try{h(this.compareEndDate)}catch(e){return!1}return!0},movePeriod:function(e){if(this.canMovePeriod(e)){var t=new Date;switch(null!=this.dateValue&&(t=this.dateValue),this.periodValue){case"day":t.setDate(t.getDate()+e);break;case"week":t.setDate(t.getDate()+7*e);break;case"month":t.setMonth(t.getMonth()+e);break;case"year":t.setFullYear(t.getFullYear()+e);break;default:break}this.dateValue<Nl&&(this.dateValue=Nl),this.dateValue>Il&&(this.dateValue=Il),this.onApplyClicked()}},isPeriodMoveDisabled:function(e){return null===this.dateValue?this.isRangeSelection:this.isRangeSelection||!this.canMovePeriod(e)},canMovePeriod:function(e){if(null===this.dateValue)return!1;var t=-1===e?Nl:Il;return!g(this.dateValue,t,this.periodValue)}}});Bl.render=Ol;var Al=Bl,Ml={class:"reportingMenu"},Ll=["aria-label"],Fl=["data-category-id"],_l=["onClick"],Rl={class:"hidden"},Hl={key:2,role:"menu"},Ul=["href","onClick","title"],$l=["href","onClick"],ql=["onClick"],Wl=Object(X["createElementVNode"])("span",{class:"icon-help"},null,-1),zl=[Wl],Gl={id:"mobile-left-menu",class:"sidenav sidenav--reporting-menu-mobile hide-on-large-only"},Yl=["data-category-id"],Jl={key:1,class:"collapsible collapsible-accordion"},Kl={class:"collapsible-header"},Ql={class:"collapsible-body"},Xl=["onClick","href"],Zl=["onClick","href"];function ec(e,t,n,r,o,a){var i=Object(X["resolveComponent"])("MenuItemsDropdown"),l=Object(X["resolveDirective"])("side-nav");return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Ml,[Object(X["createElementVNode"])("ul",{class:"navbar hide-on-med-and-down collapsible",role:"menu","aria-label":e.translate("CoreHome_MainNavigation")},[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.menu,(function(t){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{class:Object(X["normalizeClass"])(["menuTab",{active:t.id===e.activeCategory}]),role:"menuitem",key:t.id,"data-category-id":t.id},[t.component?(Object(X["openBlock"])(),Object(X["createBlock"])(Object(X["resolveDynamicComponent"])(t.component),{key:0,onAction:function(n){return e.loadCategory(t)}},null,8,["onAction"])):Object(X["createCommentVNode"])("",!0),t.component?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{key:1,class:"item",tabindex:"5",href:"",onClick:Object(X["withModifiers"])((function(n){return e.loadCategory(t)}),["prevent"])},[Object(X["createElementVNode"])("span",{class:Object(X["normalizeClass"])("menu-icon ".concat(t.icon?t.icon:t.subcategories&&t.id===e.activeCategory?"icon-chevron-down":"icon-chevron-right"))},null,2),Object(X["createTextVNode"])(Object(X["toDisplayString"])(t.name)+" ",1),Object(X["createElementVNode"])("span",Rl,Object(X["toDisplayString"])(e.translate("CoreHome_Menu")),1)],8,_l)),t.component?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("ul",Hl,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(t.subcategories,(function(n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{role:"menuitem",class:Object(X["normalizeClass"])({active:(n.id===e.displayedSubcategory||n.isGroup&&e.activeSubsubcategory===e.displayedSubcategory)&&t.id===e.displayedCategory}),key:n.id},[n.isGroup?(Object(X["openBlock"])(),Object(X["createBlock"])(i,{key:0,"show-search":!0,"menu-title":e.htmlEntities(n.name)},{default:Object(X["withCtx"])((function(){return[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(n.subcategories,(function(r){return Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{class:Object(X["normalizeClass"])(["item",{active:r.id===e.activeSubsubcategory&&n.id===e.displayedSubcategory&&t.id===e.displayedCategory}]),tabindex:"5",href:"#?".concat(e.makeUrl(t,r)),onClick:function(n){return e.loadSubcategory(t,r,n)},title:r.tooltip,key:r.id},Object(X["toDisplayString"])(r.name),11,Ul)})),128))]})),_:2},1032,["menu-title"])):Object(X["createCommentVNode"])("",!0),n.isGroup?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{key:1,href:"#?".concat(e.makeUrl(t,n)),class:"item",onClick:function(r){return e.loadSubcategory(t,n,r)}},Object(X["toDisplayString"])(n.name),9,$l)),n.help?(Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{key:2,class:Object(X["normalizeClass"])(["item-help-icon",{active:e.helpShownCategory&&e.helpShownCategory.subcategory===n.id&&e.helpShownCategory.category===t.id&&n.help}]),tabindex:"5",href:"javascript:",onClick:function(r){return e.showHelp(t,n,r)}},zl,10,ql)):Object(X["createCommentVNode"])("",!0)],2)})),128))]))],10,Fl)})),128))],8,Ll),Object(X["createElementVNode"])("ul",Gl,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.menu,(function(t){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{class:"no-padding",key:t.id,"data-category-id":t.id},[t.component?(Object(X["openBlock"])(),Object(X["createBlock"])(Object(X["resolveDynamicComponent"])(t.component),{key:0,onAction:function(n){return e.loadCategory(t)}},null,8,["onAction"])):Object(X["createCommentVNode"])("",!0),t.component?Object(X["createCommentVNode"])("",!0):Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("ul",Jl,[Object(X["createElementVNode"])("li",null,[Object(X["createElementVNode"])("a",Kl,[Object(X["createElementVNode"])("i",{class:Object(X["normalizeClass"])(t.icon?t.icon:"icon-chevron-down")},null,2),Object(X["createTextVNode"])(Object(X["toDisplayString"])(t.name),1)]),Object(X["createElementVNode"])("div",Ql,[Object(X["createElementVNode"])("ul",null,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(t.subcategories,(function(n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{key:n.id},[n.isGroup?(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],{key:0},Object(X["renderList"])(n.subcategories,(function(n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{onClick:function(r){return e.loadSubcategory(t,n)},href:"#?".concat(e.makeUrl(t,n)),key:n.id},Object(X["toDisplayString"])(n.name),9,Xl)})),128)):Object(X["createCommentVNode"])("",!0),n.isGroup?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{key:1,onClick:function(r){return e.loadSubcategory(t,n)},href:"#?".concat(e.makeUrl(t,n))},Object(X["toDisplayString"])(n.name),9,Zl))])})),128))])])])],512)),[[l,{activator:e.sideNavActivator}]])],8,Yl)})),128))])])}function tc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rc(e,t,n){return t&&nc(e.prototype,t),n&&nc(e,n),e}function oc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
+ */var Na=function(){function e(){var t=this;Da(this,e),Va(this,"state",Object(X["reactive"])({initialSites:[],isInitialized:!1})),Va(this,"stateFiltered",Object(X["reactive"])({initialSites:[],isInitialized:!1,excludedSites:[]})),Va(this,"currentRequestAbort",null),Va(this,"limitRequest",void 0),Va(this,"initialSites",Object(X["computed"])((function(){return Object(X["readonly"])(t.state.initialSites)}))),Va(this,"initialSitesFiltered",Object(X["computed"])((function(){return Object(X["readonly"])(t.stateFiltered.initialSites)})))}return Ta(e,[{key:"loadInitialSites",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.state.isInitialized&&0===n.length?Promise.resolve(Object(X["readonly"])(this.state.initialSites)):this.stateFiltered.isInitialized&&n.length===this.stateFiltered.excludedSites.length&&n.every((function(t,n){return t===e.stateFiltered.excludedSites[n]}))?Promise.resolve(Object(X["readonly"])(this.stateFiltered.initialSites)):(n.length>0&&this.searchSite("%",t,n).then((function(t){e.stateFiltered.isInitialized=!0,e.stateFiltered.excludedSites=n,null!==t&&(e.stateFiltered.initialSites=t)})),this.state.isInitialized?Promise.resolve(Object(X["readonly"])(this.state.initialSites)):this.searchSite("%",t,n).then((function(t){return e.state.isInitialized=!0,null!==t&&(e.state.initialSites=t),t})))}},{key:"loadSite",value:function(e){"all"===e?De.updateUrl(Object.assign(Object.assign({},De.urlParsed.value),{},{module:"MultiSites",action:"index",date:De.parsed.value.date,period:De.parsed.value.period})):De.updateUrl(Object.assign(Object.assign({},De.urlParsed.value),{},{segment:"",idSite:e}),Object.assign(Object.assign({},De.hashParsed.value),{},{segment:"",idSite:e}))}},{key:"searchSite",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e?(this.currentRequestAbort&&this.currentRequestAbort.abort(),this.limitRequest||(this.limitRequest=Ze.fetch({method:"SitesManager.getNumWebsitesToDisplayPerPage"})),this.limitRequest.then((function(o){var a=o.value,i="SitesManager.getPatternMatchSites";return n&&(i="SitesManager.getSitesWithAdminAccess"),t.currentRequestAbort=new AbortController,Ze.fetch({method:i,limit:a,pattern:e,sitesToExclude:r},{abortController:t.currentRequestAbort,abortable:!1})})).then((function(e){return e?t.processWebsitesList(e):null})).finally((function(){t.currentRequestAbort=null}))):this.loadInitialSites(n,r)}},{key:"processWebsitesList",value:function(e){var t=e;return t&&t.length?(t=t.map((function(e){return Object.assign(Object.assign({},e),{},{name:e.group?"[".concat(e.group,"] ").concat(e.name):e.name})})),t.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0})),t):[]}}]),e}(),Ia=new Na,xa=["value","name"],Ba=["title"],Aa=["textContent"],Ma={key:1,class:"placeholder"},La={class:"dropdown"},Fa={class:"custom_select_search"},_a=["placeholder"],Ra={key:0},Ha={class:"custom_select_container"},Ua=["onClick"],$a=["innerHTML","href","title"],qa={class:"custom_select_ul_list"},Wa={class:"noresult"},za={key:1};function Ga(e,t,n,r,o,a){var i,l,c,s,u=Object(X["resolveComponent"])("AllSitesLink"),d=Object(X["resolveDirective"])("focus-if"),m=Object(X["resolveDirective"])("tooltips"),p=Object(X["resolveDirective"])("focus-anywhere-but-here");return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{class:Object(X["normalizeClass"])(["siteSelector piwikSelector borderedControl",{expanded:e.showSitesList,disabled:!e.hasMultipleSites}])},[e.name?(Object(X["openBlock"])(),Object(X["createElementBlock"])("input",{key:0,type:"hidden",value:null===(i=e.displayedModelValue)||void 0===i?void 0:i.id,name:e.name},null,8,xa)):Object(X["createCommentVNode"])("",!0),Object(X["createElementVNode"])("a",{ref:"selectorLink",onClick:t[0]||(t[0]=function(){return e.onClickSelector&&e.onClickSelector.apply(e,arguments)}),onKeydown:t[1]||(t[1]=function(t){return e.onPressEnter(t)}),href:"javascript:void(0)",class:Object(X["normalizeClass"])([{loading:e.isLoading},"title"]),tabindex:"4",title:e.selectorLinkTitle},[Object(X["createElementVNode"])("span",{class:Object(X["normalizeClass"])(["icon icon-chevron-down",{iconHidden:e.isLoading,collapsed:!e.showSitesList}])},null,2),Object(X["createElementVNode"])("span",null,[null!==(l=e.displayedModelValue)&&void 0!==l&&l.name||!e.placeholder?(Object(X["openBlock"])(),Object(X["createElementBlock"])("span",{key:0,textContent:Object(X["toDisplayString"])((null===(c=e.displayedModelValue)||void 0===c?void 0:c.name)||e.firstSiteName)},null,8,Aa)):Object(X["createCommentVNode"])("",!0),null!==(s=e.displayedModelValue)&&void 0!==s&&s.name||!e.placeholder?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("span",Ma,Object(X["toDisplayString"])(e.placeholder),1))])],42,Ba),Object(X["withDirectives"])(Object(X["createElementVNode"])("div",La,[Object(X["withDirectives"])(Object(X["createElementVNode"])("div",Fa,[Object(X["withDirectives"])(Object(X["createElementVNode"])("input",{type:"text",onClick:t[2]||(t[2]=function(t){e.searchTerm="",e.loadInitialSites()}),"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.searchTerm=t}),tabindex:"4",class:"websiteSearch inp browser-default",placeholder:e.translate("General_Search")},null,8,_a),[[X["vModelText"],e.searchTerm],[d,{focused:e.shouldFocusOnSearch}]]),Object(X["withDirectives"])(Object(X["createElementVNode"])("img",{title:"Clear",onClick:t[4]||(t[4]=function(t){e.searchTerm="",e.loadInitialSites()}),class:"reset",src:"plugins/CoreHome/images/reset_search.png"},null,512),[[X["vShow"],e.searchTerm]])],512),[[X["vShow"],e.autocompleteMinSites<=e.sites.length||e.searchTerm]]),"top"===e.allSitesLocation&&e.showAllSitesItem?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Ra,[Object(X["createVNode"])(u,{href:e.urlAllSites,"all-sites-text":e.allSitesText,onClick:t[5]||(t[5]=function(t){return e.onAllSitesClick(t)})},null,8,["href","all-sites-text"])])):Object(X["createCommentVNode"])("",!0),Object(X["withDirectives"])(Object(X["createElementVNode"])("div",Ha,[Object(X["createElementVNode"])("ul",{class:"custom_select_ul_list",onClick:t[7]||(t[7]=function(t){return e.showSitesList=!1})},[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.sites,(function(n,r){return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{onClick:function(t){return e.switchSite(Object.assign(Object.assign({},n),{},{id:n.idsite}),t)},key:r},[Object(X["createElementVNode"])("a",{onClick:t[6]||(t[6]=function(e){return e.preventDefault()}),innerHTML:e.$sanitize(e.getMatchedSiteName(n.name)),tabindex:"4",href:e.getUrlForSiteId(n.idsite),title:n.name},null,8,$a)],8,Ua)),[[X["vShow"],!(!e.showSelectedSite&&"".concat(e.activeSiteId)==="".concat(n.idsite))]])})),128))]),Object(X["withDirectives"])(Object(X["createElementVNode"])("ul",qa,[Object(X["createElementVNode"])("li",null,[Object(X["createElementVNode"])("div",Wa,Object(X["toDisplayString"])(e.translate("SitesManager_NotFound")+" "+e.searchTerm),1)])],512),[[X["vShow"],!e.sites.length&&e.searchTerm]])],512),[[m,{content:e.tooltipContent}]]),"bottom"===e.allSitesLocation&&e.showAllSitesItem?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",za,[Object(X["createVNode"])(u,{href:e.urlAllSites,"all-sites-text":e.allSitesText,onClick:t[8]||(t[8]=function(t){return e.onAllSitesClick(t)})},null,8,["href","all-sites-text"])])):Object(X["createCommentVNode"])("",!0)],512),[[X["vShow"],e.showSitesList]])],2)),[[p,{blur:e.onBlur}]])}var Ya=["innerHTML","href"];function Ja(e,t,n,r,o,a){var i=this;return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{onClick:t[1]||(t[1]=function(e){return i.onClick(e)}),class:"custom_select_all"},[Object(X["createElementVNode"])("a",{onClick:t[0]||(t[0]=function(e){return e.preventDefault()}),innerHTML:e.$sanitize(e.allSitesText),tabindex:"4",href:e.href},null,8,Ya)])}var Ka=Object(X["defineComponent"])({props:{href:String,allSitesText:String},emits:["click"],methods:{onClick:function(e){this.$emit("click",e)}}});Ka.render=Ja;var Qa=Ka,Xa=Object(X["defineComponent"])({props:{modelValue:Object,showSelectedSite:{type:Boolean,default:!1},showAllSitesItem:{type:Boolean,default:!0},switchSiteOnSelect:{type:Boolean,default:!0},onlySitesWithAdminAccess:{type:Boolean,default:!1},name:{type:String,default:""},allSitesText:{type:String,default:a("General_MultiSitesSummary")},allSitesLocation:{type:String,default:"bottom"},placeholder:String,defaultToFirstSite:Boolean,sitesToExclude:{type:Array,default:function(){return[]}}},emits:["update:modelValue","blur"],components:{AllSitesLink:Qa},directives:{FocusAnywhereButHere:gn,FocusIf:On,Tooltips:Cn},watch:{searchTerm:function(){this.onSearchTermChanged()}},data:function(){return{searchTerm:"",activeSiteId:"".concat(ue.idSite),showSitesList:!1,isLoading:!1,sites:[],autocompleteMinSites:parseInt(ue.config.autocomplete_min_sites,10)}},created:function(){this.searchSite=$t(this.searchSite),!this.modelValue&&ue.idSite&&this.$emit("update:modelValue",{id:ue.idSite,name:ue.helper.htmlDecode(ue.siteName)})},mounted:function(){var e=this;window.initTopControls(),this.loadInitialSites().then((function(){e.shouldDefaultToFirstSite&&e.$emit("update:modelValue",{id:e.sites[0].idsite,name:e.sites[0].name})}));var t=a("CoreHome_ShortcutWebsiteSelector");ue.helper.registerShortcut("w",t,(function(t){if(!t.altKey){t.preventDefault?t.preventDefault():t.returnValue=!1;var n=e.$refs.selectorLink;n&&(n.click(),n.focus())}}))},computed:{shouldFocusOnSearch:function(){return this.showSitesList&&this.autocompleteMinSites<=this.sites.length||this.searchTerm},selectorLinkTitle:function(){var e;return this.hasMultipleSites?a("CoreHome_ChangeCurrentWebsite",(null===(e=this.modelValue)||void 0===e?void 0:e.name)||this.firstSiteName):""},hasMultipleSites:function(){var e=Ia.initialSitesFiltered.value&&Ia.initialSitesFiltered.value.length?Ia.initialSitesFiltered.value:Ia.initialSites.value;return e&&e.length>1},firstSiteName:function(){var e=Ia.initialSitesFiltered.value&&Ia.initialSitesFiltered.value.length?Ia.initialSitesFiltered.value:Ia.initialSites.value;return e&&e.length>0?e[0].name:""},urlAllSites:function(){var e=De.stringify(Object.assign(Object.assign({},De.urlParsed.value),{},{module:"MultiSites",action:"index",date:De.parsed.value.date,period:De.parsed.value.period}));return"?".concat(e)},shouldDefaultToFirstSite:function(){var e;return!(null!==(e=this.modelValue)&&void 0!==e&&e.id)&&(!this.hasMultipleSites||this.defaultToFirstSite)&&this.sites[0]},displayedModelValue:function(){return this.modelValue?this.modelValue:ue.idSite?{id:ue.idSite,name:ue.helper.htmlDecode(ue.siteName)}:this.shouldDefaultToFirstSite?{id:this.sites[0].idsite,name:this.sites[0].name}:null},tooltipContent:function(){return function(){var e=$(this).attr("title")||"";return ue.helper.htmlEntities(e)}}},methods:{onSearchTermChanged:function(){this.searchTerm?(this.isLoading=!0,this.searchSite(this.searchTerm)):(this.isLoading=!1,this.loadInitialSites())},onAllSitesClick:function(e){this.switchSite({id:"all",name:this.$props.allSitesText},e),this.showSitesList=!1},switchSite:function(e,t){var n=-1!==navigator.userAgent.indexOf("Mac OS X")?t.metaKey:t.ctrlKey;t&&n&&t.target&&t.target.href?window.open(t.target.href,"_blank"):(this.$emit("update:modelValue",{id:e.id,name:e.name}),this.switchSiteOnSelect&&this.activeSiteId!==e.id&&Ia.loadSite(e.id))},onBlur:function(){this.showSitesList=!1,this.$emit("blur")},onClickSelector:function(){this.hasMultipleSites&&(this.showSitesList=!this.showSitesList,this.isLoading||this.searchTerm||this.loadInitialSites())},onPressEnter:function(e){"Enter"===e.key&&(e.preventDefault(),this.showSitesList=!this.showSitesList,this.showSitesList&&!this.isLoading&&this.loadInitialSites())},getMatchedSiteName:function(e){var t=e.toUpperCase().indexOf(this.searchTerm.toUpperCase());if(-1===t||this.isLoading)return this.htmlEntities(e);var n=this.htmlEntities(e.substring(0,t)),r=this.htmlEntities(e.substring(t+this.searchTerm.length));return"".concat(n,'<span class="autocompleteMatched">').concat(this.searchTerm,"</span>").concat(r)},loadInitialSites:function(){var e=this;return Ia.loadInitialSites(this.onlySitesWithAdminAccess,this.sitesToExclude?this.sitesToExclude:[]).then((function(t){e.sites=t||[]}))},searchSite:function(e){var t=this;this.isLoading=!0,Ia.searchSite(e,this.onlySitesWithAdminAccess,this.sitesToExclude?this.sitesToExclude:[]).then((function(n){e===t.searchTerm&&n&&(t.sites=n)})).finally((function(){t.isLoading=!1}))},getUrlForSiteId:function(e){var t=De.stringify(Object.assign(Object.assign({},De.urlParsed.value),{},{segment:"",idSite:e})),n=De.stringify(Object.assign(Object.assign({},De.hashParsed.value),{},{segment:"",idSite:e}));return"?".concat(t,"#?").concat(n)},htmlEntities:function(e){return ue.helper.htmlEntities(e)}}});Xa.render=Ga;var Za=Xa,ei={ref:"root",class:"quickAccessInside"},ti=["title","placeholder"],ni={class:"dropdown"},ri={class:"no-result"},oi=["onClick"],ai=["onMouseenter","onClick"],ii={class:"quickAccessMatomoSearch"},li=["onMouseenter","onClick"],ci=["textContent"],si={class:"quick-access-category helpCategory"},ui=["href"];function di(e,t,n,r,o,a){var i=Object(X["resolveDirective"])("focus-if"),l=Object(X["resolveDirective"])("focus-anywhere-but-here");return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("div",ei,[Object(X["createElementVNode"])("span",{class:"icon-search",onMouseenter:t[0]||(t[0]=function(t){return e.searchActive=!0})},null,32),Object(X["withDirectives"])(Object(X["createElementVNode"])("input",{class:"s",onKeydown:t[1]||(t[1]=function(t){return e.onKeypress(t)}),onFocus:t[2]||(t[2]=function(t){return e.searchActive=!0}),"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.searchTerm=t}),type:"text",tabindex:"2",title:e.quickAccessTitle,placeholder:e.translate("General_Search"),ref:"input"},null,40,ti),[[X["vModelText"],e.searchTerm],[i,{focused:e.searchActive}]]),Object(X["withDirectives"])(Object(X["createElementVNode"])("div",ni,[Object(X["withDirectives"])(Object(X["createElementVNode"])("ul",null,[Object(X["createElementVNode"])("li",ri,Object(X["toDisplayString"])(e.translate("General_SearchNoResults")),1)],512),[[X["vShow"],!(e.numMenuItems>0||e.sites.length)]]),(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.menuItems,(function(t){return Object(X["openBlock"])(),Object(X["createElementBlock"])("ul",{key:t.title},[Object(X["createElementVNode"])("li",{class:"quick-access-category",onClick:function(n){e.searchTerm=t.title,e.searchMenu(e.searchTerm)}},Object(X["toDisplayString"])(t.title),9,oi),(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(t.items,(function(t){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{class:Object(X["normalizeClass"])(["result",{selected:t.menuIndex===e.searchIndex}]),onMouseenter:function(n){return e.searchIndex=t.menuIndex},onClick:function(n){return e.selectMenuItem(t.index)},key:t.index},[Object(X["createElementVNode"])("a",null,Object(X["toDisplayString"])(t.name.trim()),1)],42,ai)})),128))])})),128)),Object(X["createElementVNode"])("ul",ii,[Object(X["withDirectives"])(Object(X["createElementVNode"])("li",{class:"quick-access-category websiteCategory"},Object(X["toDisplayString"])(e.translate("SitesManager_Sites")),513),[[X["vShow"],e.hasSitesSelector&&e.sites.length||e.isLoading]]),Object(X["withDirectives"])(Object(X["createElementVNode"])("li",{class:"no-result"},Object(X["toDisplayString"])(e.translate("MultiSites_LoadingWebsites")),513),[[X["vShow"],e.hasSitesSelector&&e.isLoading]]),(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.sites,(function(t,n){return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{class:Object(X["normalizeClass"])(["result",{selected:e.numMenuItems+n===e.searchIndex}]),onMouseenter:function(t){return e.searchIndex=e.numMenuItems+n},onClick:function(n){return e.selectSite(t.idsite)},key:t.idsite},[Object(X["createElementVNode"])("a",{textContent:Object(X["toDisplayString"])(t.name)},null,8,ci)],42,li)),[[X["vShow"],e.hasSitesSelector&&!e.isLoading]])})),128))]),Object(X["createElementVNode"])("ul",null,[Object(X["createElementVNode"])("li",si,Object(X["toDisplayString"])(e.translate("General_HelpResources")),1),Object(X["createElementVNode"])("li",{class:Object(X["normalizeClass"])([{selected:"help"===e.searchIndex},"quick-access-help"]),onMouseenter:t[4]||(t[4]=function(t){return e.searchIndex="help"})},[Object(X["createElementVNode"])("a",{href:"https://matomo.org?mtm_campaign=App_Help&mtm_source=Matomo_App&mtm_keyword=QuickSearch&s=".concat(encodeURIComponent(e.searchTerm)),target:"_blank"},Object(X["toDisplayString"])(e.translate("CoreHome_SearchOnMatomo",e.searchTerm)),9,ui)],34)])],512),[[X["vShow"],e.searchTerm&&e.searchActive]])],512)),[[l,{blur:e.onBlur}]])}var mi=window,pi=mi.ListingFormatter;function fi(e){var t=e.getBoundingClientRect(),n=window.$(window);return t.top>=0&&t.left>=0&&t.bottom<=n.height()&&t.right<=n.width()}function hi(e){e&&e.scrollIntoView&&e.scrollIntoView()}var bi=Object(X["defineComponent"])({directives:{FocusAnywhereButHere:gn,FocusIf:On},watch:{searchActive:function(e){var t=this.$refs.root;if(t&&t.parentElement){var n=t.parentElement.classList;n.toggle("active",e),n.toggle("expanded",e)}}},mounted:function(){var e=this,t=this.$refs.root;t&&t.parentElement&&t.parentElement.classList.add("quick-access","piwikSelector"),"undefined"!==typeof window.initTopControls&&window.initTopControls&&window.initTopControls(),ue.helper.registerShortcut("f",a("CoreHome_ShortcutSearch"),(function(t){t.altKey||(t.preventDefault(),hi(e.$refs.root),e.activateSearch())}))},data:function(){var e=!!document.querySelector(".segmentEditorPanel");return{menuItems:[],numMenuItems:0,searchActive:!1,searchTerm:"",searchIndex:0,menuIndexCounter:-1,topMenuItems:null,leftMenuItems:null,segmentItems:null,hasSegmentSelector:e,sites:[],isLoading:!1}},created:function(){this.searchMenu=$t(this.searchMenu.bind(this))},computed:{hasSitesSelector:function(){return!!document.querySelector('.top_controls .siteSelector,.top_controls [vue-entry="CoreHome.SiteSelector"]')},quickAccessTitle:function(){var e=[a("CoreHome_MenuEntries")];return this.hasSegmentSelector&&e.push(a("CoreHome_Segments")),this.hasSitesSelector&&e.push(a("SitesManager_Sites")),a("CoreHome_QuickAccessTitle",pi.formatAnd(e))}},emits:["itemSelected","blur"],methods:{onKeypress:function(e){var t=this,n=this.searchTerm&&this.searchActive,r=9===e.which,o=27===e.which;38===e.which?(this.highlightPreviousItem(),e.preventDefault()):40===e.which?(this.highlightNextItem(),e.preventDefault()):13===e.which?this.clickQuickAccessMenuItem():r&&n||o&&n?this.deactivateSearch():setTimeout((function(){t.searchActive=!0,t.searchMenu(t.searchTerm)}))},highlightPreviousItem:function(){this.searchIndex-1<0?this.searchIndex=0:this.searchIndex-=1,this.makeSureSelectedItemIsInViewport()},highlightNextItem:function(){var e=this.$refs.root.querySelectorAll("li.result").length;e<=this.searchIndex+1?this.searchIndex=e-1:this.searchIndex+=1,this.makeSureSelectedItemIsInViewport()},clickQuickAccessMenuItem:function(){var e=this,t=this.getCurrentlySelectedElement();t&&setTimeout((function(){t.click(),e.$emit("itemSelected",t)}),20)},deactivateSearch:function(){this.searchTerm="",this.searchActive=!1,this.$refs.input&&this.$refs.input.blur()},makeSureSelectedItemIsInViewport:function(){var e=this.getCurrentlySelectedElement();e&&!fi(e)&&hi(e)},getCurrentlySelectedElement:function(){var e=this.$refs.root.querySelectorAll("li.result");if(e&&e.length&&e.item(this.searchIndex))return e.item(this.searchIndex)},searchMenu:function(e){var t=this,n=e.toLowerCase(),r=-1,o={},a=[],i=function(e){var t=Object.assign({},e);r+=1,t.menuIndex=r;var n=t.category;n in o||(a.push({title:n,items:[]}),o[n]=a.length-1);var i=o[n];a[i].items.push(t)};this.resetSearchIndex(),this.hasSitesSelector&&(this.isLoading=!0,Ia.searchSite(n).then((function(e){e&&(t.sites=e)})).finally((function(){t.isLoading=!1})));var l=function(e){return-1!==e.name.toLowerCase().indexOf(n)||-1!==e.category.toLowerCase().indexOf(n)};null===this.topMenuItems&&(this.topMenuItems=this.getTopMenuItems()),null===this.leftMenuItems&&(this.leftMenuItems=this.getLeftMenuItems()),null===this.segmentItems&&(this.segmentItems=this.getSegmentItems());var c=this.topMenuItems.filter(l),s=this.leftMenuItems.filter(l),u=this.segmentItems.filter(l);c.forEach(i),s.forEach(i),u.forEach(i),this.numMenuItems=c.length+s.length+u.length,this.menuItems=a},resetSearchIndex:function(){this.searchIndex=0,this.makeSureSelectedItemIsInViewport()},selectSite:function(e){Ia.loadSite(e)},selectMenuItem:function(e){var t=document.querySelector("[quick_access='".concat(e,"']"));if(t){this.deactivateSearch();var n=t.getAttribute("href");if(n&&n.length>10&&t&&t.click)try{t.click()}catch(r){window.$(t).click()}else window.$(t).click()}},onBlur:function(){this.searchActive=!1,this.$emit("blur")},activateSearch:function(){this.searchActive=!0},getTopMenuItems:function(){var e=this,t=a("CoreHome_Menu"),n=[];return document.querySelectorAll("nav .sidenav li > a, nav .sidenav li > div > a").forEach((function(r){var o,a,i=null===(o=r.textContent)||void 0===o?void 0:o.trim();(!i||null!=r.parentElement&&null!=r.parentElement.tagName&&"DIV"===r.parentElement.tagName)&&(i=null===(a=r.getAttribute("title"))||void 0===a?void 0:a.trim());i&&(n.push({name:i,index:e.menuIndexCounter+=1,category:t}),r.setAttribute("quick_access","".concat(e.menuIndexCounter)))})),n},getLeftMenuItems:function(){var e=this,t=[];return document.querySelectorAll("#secondNavBar .menuTab").forEach((function(n){var r,o=window.$(n).find("> .item"),a=(null===(r=o[0])||void 0===r?void 0:r.innerText.trim())||"";a&&-1!==a.lastIndexOf("\n")&&(a=a.slice(0,a.lastIndexOf("\n")).trim()),window.$(n).find("li .item").each((function(n,r){var o,i=null===(o=r.textContent)||void 0===o?void 0:o.trim();i&&(t.push({name:i,category:a,index:e.menuIndexCounter+=1}),r.setAttribute("quick_access","".concat(e.menuIndexCounter)))}))})),t},getSegmentItems:function(){var e=this;if(!this.hasSegmentSelector)return[];var t=a("CoreHome_Segments"),n=[];return document.querySelectorAll(".segmentList [data-idsegment]").forEach((function(r){var o,a,i=null===(o=r.querySelector(".segname"))||void 0===o||null===(a=o.textContent)||void 0===a?void 0:a.trim();i&&(n.push({name:i,category:t,index:e.menuIndexCounter+=1}),r.setAttribute("quick_access","".concat(e.menuIndexCounter)))})),n}}});bi.render=di;var vi=bi;function gi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yi={class:"fieldArray form-group"},Oi={key:0,class:"fieldUiControl"},ji=["onClick","title"];function wi(e,t,n,r,o,a){var i=Object(X["resolveComponent"])("Field");return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",yi,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.modelValue,(function(t,n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{class:Object(X["normalizeClass"])(["fieldArrayTable multiple valign-wrapper",gi({},"fieldArrayTable".concat(n),!0)]),key:n},[e.field.uiControl?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Oi,[Object(X["createVNode"])(i,{"full-width":!0,"model-value":t,options:e.field.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(t,n)},"model-modifiers":e.field.modelModifiers,placeholder:" ",uicontrol:e.field.uiControl,title:e.field.title,name:"".concat(e.name,"-").concat(n),"template-file":e.field.templateFile,component:e.field.component},null,8,["model-value","options","onUpdate:modelValue","model-modifiers","uicontrol","title","name","template-file","component"])])):Object(X["createCommentVNode"])("",!0),Object(X["withDirectives"])(Object(X["createElementVNode"])("span",{onClick:function(t){return e.removeEntry(n)},class:"icon-minus valign",title:e.translate("General_Remove")},null,8,ji),[[X["vShow"],n+1!==e.modelValue.length]])],2)})),128))])}function ki(e){return Di(e)||Ei(e)||Ci(e)||Si()}function Si(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ci(e,t){if(e){if("string"===typeof e)return Pi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pi(e,t):void 0}}function Ei(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Di(e){if(Array.isArray(e))return Pi(e)}function Pi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ti=_t("CorePluginsAdmin","Field"),Vi=Object(X["defineComponent"])({props:{modelValue:Array,name:String,field:Object,rows:String},components:{Field:Ti},emits:["update:modelValue"],watch:{modelValue:function(e){this.checkEmptyModelValue(e)}},mounted:function(){this.checkEmptyModelValue(this.modelValue)},methods:{checkEmptyModelValue:function(e){e&&e.length&&""===e.slice(-1)[0]||this.rows&&!((this.modelValue||[]).length<parseInt(this.rows,10))||this.$emit("update:modelValue",[].concat(ki(e||[]),[""]))},onEntryChange:function(e,t){var n=ki(this.modelValue||[]);n[t]=e,this.$emit("update:modelValue",n)},removeEntry:function(e){if(e>-1&&this.modelValue){var t=this.modelValue.filter((function(t,n){return n!==e}));this.$emit("update:modelValue",t)}}}});Vi.render=wi;var Ni=Vi;function Ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xi={class:"multiPairField form-group"},Bi={key:1,class:"fieldUiControl fieldUiControl2"},Ai={key:2,class:"fieldUiControl fieldUiControl3"},Mi={key:3,class:"fieldUiControl fieldUiControl4"},Li=["onClick","title"];function Fi(e,t,n,r,o,a){var i=Object(X["resolveComponent"])("Field");return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",xi,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.modelValue,(function(t,n){var r;return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{class:Object(X["normalizeClass"])(["multiPairFieldTable multiple valign-wrapper",(r={},Ii(r,"multiPairFieldTable".concat(n),!0),Ii(r,"has".concat(e.fieldCount,"Fields"),!0),r)]),key:n},[e.field1?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{key:0,class:Object(X["normalizeClass"])(["fieldUiControl fieldUiControl1",{hasMultiFields:e.field1.type&&e.field2.type}])},[Object(X["createVNode"])(i,{"full-width":!0,"model-value":t[e.field1.key],options:e.field1.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(n,e.field1.key,t)},"model-modifiers":e.field1.modelModifiers,placeholder:" ",uicontrol:e.field1.uiControl,name:"".concat(e.name,"-p1-").concat(n),title:e.field1.title,"template-file":e.field1.templateFile,component:e.field1.component},null,8,["model-value","options","onUpdate:modelValue","model-modifiers","uicontrol","name","title","template-file","component"])],2)):Object(X["createCommentVNode"])("",!0),e.field2?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Bi,[Object(X["createVNode"])(i,{"full-width":!0,options:e.field2.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(n,e.field2.key,t)},"model-value":t[e.field2.key],"model-modifiers":e.field2.modelModifiers,placeholder:" ",uicontrol:e.field2.uiControl,name:"".concat(e.name,"-p2-").concat(n),title:e.field2.title,"template-file":e.field2.templateFile,component:e.field2.component},null,8,["options","onUpdate:modelValue","model-value","model-modifiers","uicontrol","name","title","template-file","component"])])):Object(X["createCommentVNode"])("",!0),e.field3?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Ai,[Object(X["createVNode"])(i,{"full-width":!0,options:e.field3.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(n,e.field3.key,t)},"model-value":t[e.field3.key],"model-modifiers":e.field3.modelModifiers,placeholder:" ",uicontrol:e.field3.uiControl,title:e.field3.title,"template-file":e.field3.templateFile,component:e.field3.component},null,8,["options","onUpdate:modelValue","model-value","model-modifiers","uicontrol","title","template-file","component"])])):Object(X["createCommentVNode"])("",!0),e.field4?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Mi,[Object(X["createVNode"])(i,{"full-width":!0,options:e.field4.availableValues,"onUpdate:modelValue":function(t){return e.onEntryChange(n,e.field4.key,t)},"model-value":t[e.field4.key],"model-modifiers":e.field4.modelModifiers,placeholder:" ",uicontrol:e.field4.uiControl,title:e.field4.title,"template-file":e.field4.templateFile,component:e.field4.component},null,8,["options","onUpdate:modelValue","model-value","model-modifiers","uicontrol","title","template-file","component"])])):Object(X["createCommentVNode"])("",!0),Object(X["withDirectives"])(Object(X["createElementVNode"])("span",{onClick:function(t){return e.removeEntry(n)},class:"icon-minus valign",title:e.translate("General_Remove")},null,8,Li),[[X["vShow"],n+1!==e.modelValue.length]])],2)})),128))])}function _i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ri(e){return qi(e)||$i(e)||Ui(e)||Hi()}function Hi(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ui(e,t){if(e){if("string"===typeof e)return Wi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wi(e,t):void 0}}function $i(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function qi(e){if(Array.isArray(e))return Wi(e)}function Wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zi=_t("CorePluginsAdmin","Field"),Gi=Object(X["defineComponent"])({props:{modelValue:Array,name:String,field1:Object,field2:Object,field3:Object,field4:Object,rows:Number},components:{Field:zi},computed:{fieldCount:function(){return this.field1&&this.field2&&this.field3&&this.field4?4:this.field1&&this.field2&&this.field3?3:this.field1&&this.field2?2:this.field1?1:0}},emits:["update:modelValue"],watch:{modelValue:function(e){this.checkEmptyModelValue(e)}},mounted:function(){this.checkEmptyModelValue(this.modelValue)},methods:{checkEmptyModelValue:function(e){e&&e.length&&!this.isEmptyValue(e.slice(-1)[0])||this.rows&&!(this.modelValue.length<this.rows)||this.$emit("update:modelValue",[].concat(Ri(e||[]),[this.makeEmptyValue()]))},onEntryChange:function(e,t,n){var r=Ri(this.modelValue);r[e]=Object.assign(Object.assign({},r[e]),{},_i({},t,n)),this.$emit("update:modelValue",r)},removeEntry:function(e){if(e>-1&&this.modelValue){var t=this.modelValue.filter((function(t,n){return n!==e}));this.$emit("update:modelValue",t)}},isEmptyValue:function(e){var t=this.fieldCount;if(4===t){if(!e[this.field1.key]&&!e[this.field2.key]&&!e[this.field3.key]&&!e[this.field4.key])return!1}else if(3===t){if(!e[this.field1.key]&&!e[this.field2.key]&&!e[this.field3.key])return!1}else if(2===t){if(!e[this.field1.key]&&!e[this.field2.key])return!1}else if(1===t&&!e[this.field1.key])return!1;return!0},makeEmptyValue:function(){var e={};return this.field1&&this.field1.key&&(e[this.field1.key]=""),this.field2&&this.field2.key&&(e[this.field2.key]=""),this.field3&&this.field3.key&&(e[this.field3.key]=""),this.field4&&this.field4.key&&(e[this.field4.key]=""),e}}});Gi.render=Fi;var Yi=Gi,Ji=["disabled"],Ki=Object(X["createElementVNode"])("span",{class:"icon-chevron-left"},null,-1),Qi=[Ki],Xi=["title"],Zi=Object(X["createElementVNode"])("span",{class:"icon icon-calendar"},null,-1),el={id:"periodMore",class:"dropdown"},tl={class:"flex"},nl={key:0,class:"period-date"},rl={class:"period-type"},ol={id:"otherPeriods"},al=["onDblclick","title"],il=["id","checked","onChange","onDblclick"],ll={key:0,class:"compare-checkbox"},cl={id:"comparePeriodToDropdown"},sl={key:1,class:"compare-date-range"},ul={id:"comparePeriodStartDate"},dl=Object(X["createElementVNode"])("span",{class:"compare-dates-separator"},null,-1),ml={id:"comparePeriodEndDate"},pl={class:"apply-button-container"},fl=["disabled","value"],hl={key:2,id:"ajaxLoadingCalendar"},bl={class:"loadingSegment"},vl=["disabled"],gl=Object(X["createElementVNode"])("span",{class:"icon-chevron-right"},null,-1),yl=[gl];function Ol(e,t,n,r,o,a){var i=Object(X["resolveComponent"])("DateRangePicker"),l=Object(X["resolveComponent"])("PeriodDatePicker"),c=Object(X["resolveComponent"])("Field"),s=Object(X["resolveComponent"])("ActivityIndicator"),u=Object(X["resolveDirective"])("expand-on-click");return Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("div",{ref:"root",class:Object(X["normalizeClass"])(["periodSelector piwikSelector",{"periodSelector-withPrevNext":e.canShowMovePeriod}])},[e.canShowMovePeriod?(Object(X["openBlock"])(),Object(X["createElementBlock"])("button",{key:0,class:"move-period move-period-prev",onClick:t[0]||(t[0]=function(t){return e.movePeriod(-1)}),disabled:e.isPeriodMoveDisabled(-1)},Qi,8,Ji)):Object(X["createCommentVNode"])("",!0),Object(X["createElementVNode"])("a",{ref:"title",id:"date",class:"title",tabindex:"-1",title:e.translate("General_ChooseDate",e.currentlyViewingText)},[Zi,Object(X["createTextVNode"])(" "+Object(X["toDisplayString"])(e.currentlyViewingText),1)],8,Xi),Object(X["createElementVNode"])("div",el,[Object(X["createElementVNode"])("div",tl,[Object(X["createElementVNode"])("div",null,[Object(X["withDirectives"])(Object(X["createVNode"])(i,{class:"period-range","start-date":e.startRangeDate,"end-date":e.endRangeDate,onRangeChange:t[1]||(t[1]=function(t){return e.onRangeChange(t.start,t.end)}),onSubmit:t[2]||(t[2]=function(t){return e.onApplyClicked()})},null,8,["start-date","end-date"]),[[X["vShow"],"range"===e.selectedPeriod]]),"range"!==e.selectedPeriod?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",nl,[Object(X["createVNode"])(l,{id:"datepicker",period:e.selectedPeriod,date:e.periodValue===e.selectedPeriod?e.dateValue:null,onSelect:t[3]||(t[3]=function(t){return e.setPiwikPeriodAndDate(e.selectedPeriod,t.date)})},null,8,["period","date"])])):Object(X["createCommentVNode"])("",!0)]),Object(X["createElementVNode"])("div",rl,[Object(X["createElementVNode"])("h6",null,Object(X["toDisplayString"])(e.translate("General_Period")),1),Object(X["createElementVNode"])("div",ol,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.periodsFiltered,(function(n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("p",{key:n},[Object(X["createElementVNode"])("label",{class:Object(X["normalizeClass"])({"selected-period-label":n===e.selectedPeriod}),onDblclick:function(t){return e.changeViewedPeriod(n)},title:n===e.periodValue?"":e.translate("General_DoubleClickToChangePeriod")},[Object(X["withDirectives"])(Object(X["createElementVNode"])("input",{type:"radio",name:"period",id:"period_id_".concat(n),"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.selectedPeriod=t}),checked:e.selectedPeriod===n,onChange:function(t){return e.selectedPeriod=n},onDblclick:function(t){return e.changeViewedPeriod(n)}},null,40,il),[[X["vModelRadio"],e.selectedPeriod]]),Object(X["createElementVNode"])("span",null,Object(X["toDisplayString"])(e.getPeriodDisplayText(n)),1)],42,al)])})),128))])])]),e.isComparisonEnabled?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",ll,[Object(X["createElementVNode"])("label",null,[Object(X["withDirectives"])(Object(X["createElementVNode"])("input",{id:"comparePeriodTo",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.isComparing=t})},null,512),[[X["vModelCheckbox"],e.isComparing]]),Object(X["createElementVNode"])("span",null,Object(X["toDisplayString"])(e.translate("General_CompareTo")),1)]),Object(X["createElementVNode"])("div",cl,[Object(X["createVNode"])(c,{modelValue:e.comparePeriodType,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.comparePeriodType=t}),style:Object(X["normalizeStyle"])({visibility:e.isComparing?"visible":"hidden"}),name:"comparePeriodToDropdown",uicontrol:"select",options:e.comparePeriodDropdownOptions,"full-width":!0,disabled:!e.isComparing},null,8,["modelValue","style","options","disabled"])])])):Object(X["createCommentVNode"])("",!0),e.isComparing&&"custom"===e.comparePeriodType?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",sl,[Object(X["createElementVNode"])("div",null,[Object(X["createElementVNode"])("div",ul,[Object(X["createElementVNode"])("div",null,[Object(X["createVNode"])(c,{modelValue:e.compareStartDate,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.compareStartDate=t}),name:"comparePeriodStartDate",uicontrol:"text","full-width":!0,title:e.translate("CoreHome_StartDate"),placeholder:"YYYY-MM-DD"},null,8,["modelValue","title"])])]),dl,Object(X["createElementVNode"])("div",ml,[Object(X["createElementVNode"])("div",null,[Object(X["createVNode"])(c,{modelValue:e.compareEndDate,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.compareEndDate=t}),name:"comparePeriodEndDate",uicontrol:"text","full-width":!0,title:e.translate("CoreHome_EndDate"),placeholder:"YYYY-MM-DD"},null,8,["modelValue","title"])])])])])):Object(X["createCommentVNode"])("",!0),Object(X["createElementVNode"])("div",pl,[Object(X["createElementVNode"])("input",{type:"submit",id:"calendarApply",class:"btn",onClick:t[9]||(t[9]=function(t){return e.onApplyClicked()}),disabled:!e.isApplyEnabled(),value:e.translate("General_Apply")},null,8,fl)]),e.isLoadingNewPage?(Object(X["openBlock"])(),Object(X["createElementBlock"])("div",hl,[Object(X["createVNode"])(s,{loading:!0}),Object(X["createElementVNode"])("div",bl,Object(X["toDisplayString"])(e.translate("SegmentEditor_LoadingSegmentedDataMayTakeSomeTime")),1)])):Object(X["createCommentVNode"])("",!0)]),e.canShowMovePeriod?(Object(X["openBlock"])(),Object(X["createElementBlock"])("button",{key:1,class:"move-period move-period-next",onClick:t[10]||(t[10]=function(t){return e.movePeriod(1)}),disabled:e.isPeriodMoveDisabled(1)},yl,8,vl)):Object(X["createCommentVNode"])("",!0)],2)),[[u,{expander:"title"}]])}function jl(e,t){return El(e)||Cl(e,t)||kl(e,t)||wl()}function wl(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kl(e,t){if(e){if("string"===typeof e)return Sl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sl(e,t):void 0}}function Sl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cl(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done);i=!0)if(a.push(r.value),t&&a.length===t)break}catch(c){l=!0,o=c}finally{try{i||null==n["return"]||n["return"]()}finally{if(l)throw o}}return a}}function El(e){if(Array.isArray(e))return e}var Dl=_t("CorePluginsAdmin","Field"),Pl=ue.helper.htmlDecode("&nbsp;"),Tl=["custom","previousPeriod","previousYear"],Vl=[{key:"custom",value:a("General_Custom")},{key:"previousPeriod",value:a("General_PreviousPeriod").replace(/\s+/,Pl)},{key:"previousYear",value:a("General_PreviousYear").replace(/\s+/,Pl)}],Nl=new Date(ue.minDateYear,ue.minDateMonth-1,ue.minDateDay),Il=new Date(ue.maxDateYear,ue.maxDateMonth-1,ue.maxDateDay);function xl(e){return"[object Date]"===Object.prototype.toString.call(e)&&!Number.isNaN(e.getTime())}var Bl=Object(X["defineComponent"])({props:{periods:Array},components:{DateRangePicker:qo,PeriodDatePicker:Jo,Field:Dl,ActivityIndicator:ln},directives:{ExpandOnClick:Fn},data:function(){var e=De.parsed.value.period;return{comparePeriodDropdownOptions:Vl,periodValue:e,dateValue:null,selectedPeriod:e,startRangeDate:null,endRangeDate:null,isRangeValid:null,isLoadingNewPage:!1,isComparing:null,comparePeriodType:"previousPeriod",compareStartDate:"",compareEndDate:""}},mounted:function(){var e=this;ue.on("hidePeriodSelector",(function(){window.$(e.$refs.root).parent("#periodString").hide()})),ue.on("matomoPageChange",(function(){window.$(e.$refs.root).parent("#periodString").show()})),this.isComparing=fo.isComparingPeriods(),Object(X["watch"])((function(){return fo.isComparingPeriods()}),(function(t){e.isComparing=t})),this.updateSelectedValuesFromHash(),Object(X["watch"])((function(){return De.parsed.value}),this.updateSelectedValuesFromHash),this.updateComparisonValuesFromStore(),Object(X["watch"])((function(){return fo.getPeriodComparisons()}),this.updateComparisonValuesFromStore),window.initTopControls(),this.handleZIndexPositionRelativeCompareDropdownIssue()},computed:{currentlyViewingText:function(){var e;if("range"===this.periodValue){if(!this.startRangeDate||!this.endRangeDate)return a("General_Error");e="".concat(this.startRangeDate,",").concat(this.endRangeDate)}else{if(!this.dateValue)return a("General_Error");e=p(this.dateValue)}try{return m.parse(this.periodValue,e).getPrettyString()}catch(t){return a("General_Error")}},isComparisonEnabled:function(){return fo.isComparisonEnabled()},periodsFiltered:function(){return(this.periods||[]).filter((function(e){return m.isRecognizedPeriod(e)}))},selectedComparisonParams:function(){if(!this.isComparing)return{};if("custom"===this.comparePeriodType)return{comparePeriods:["range"],comparePeriodType:"custom",compareDates:["".concat(this.compareStartDate,",").concat(this.compareEndDate)]};if("previousPeriod"===this.comparePeriodType)return{comparePeriods:[this.selectedPeriod],comparePeriodType:"previousPeriod",compareDates:[this.previousPeriodDateToSelectedPeriod]};if("previousYear"===this.comparePeriodType){var e="range"===this.selectedPeriod?"".concat(this.startRangeDate,",").concat(this.endRangeDate):p(this.dateValue),t=m.parse(this.selectedPeriod,e).getDateRange();return t[0].setFullYear(t[0].getFullYear()-1),t[1].setFullYear(t[1].getFullYear()-1),"range"===this.selectedPeriod?{comparePeriods:["range"],comparePeriodType:"previousYear",compareDates:["".concat(p(t[0]),",").concat(p(t[1]))]}:{comparePeriods:[this.selectedPeriod],comparePeriodType:"previousYear",compareDates:[p(t[0])]}}return console.warn("Unknown compare period type: ".concat(this.comparePeriodType)),{}},previousPeriodDateToSelectedPeriod:function(){if("range"===this.selectedPeriod){var e=h(this.startRangeDate),t=h(this.endRangeDate),n=K.getLastNRange("day",2,e).startDate,r=Math.floor((t.valueOf()-e.valueOf())/864e5),o=K.getLastNRange("day",1+r,n);return"".concat(p(o.startDate),",").concat(p(o.endDate))}var a=K.getLastNRange(this.selectedPeriod,2,this.dateValue).startDate;return p(a)},selectedDateString:function(){if("range"===this.selectedPeriod){var e=this.startRangeDate,t=this.endRangeDate,n=h(e),r=h(t);return!xl(n)||!xl(r)||n>r?(window.$("#alert").find("h2").text(a("General_InvalidDateRange")),ue.helper.modalConfirm("#alert",{}),null):"".concat(e,",").concat(t)}return p(this.dateValue)},isErrorDisplayed:function(){return this.currentlyViewingText===a("General_Error")},isRangeSelection:function(){return"range"===this.periodValue},canShowMovePeriod:function(){return!this.isRangeSelection&&!this.isErrorDisplayed}},methods:{handleZIndexPositionRelativeCompareDropdownIssue:function(){var e=window.$(this.$refs.root);e.on("focus","#comparePeriodToDropdown .select-dropdown",(function(){e.addClass("compare-dropdown-open")})).on("blur","#comparePeriodToDropdown .select-dropdown",(function(){e.removeClass("compare-dropdown-open")}))},changeViewedPeriod:function(e){e!==this.periodValue&&"range"!==e&&this.setPiwikPeriodAndDate(e,this.dateValue)},setPiwikPeriodAndDate:function(e,t){this.periodValue=e,this.selectedPeriod=e,this.dateValue=t;var n=p(t);this.setRangeStartEndFromPeriod(e,n),this.propagateNewUrlParams(n,this.selectedPeriod),window.initTopControls()},propagateNewUrlParams:function(e,t){var n,r=this.selectedComparisonParams;ue.helper.isReportingPage()?(this.closePeriodSelector(),n=De.hashParsed.value):(this.isLoadingNewPage=!0,n=De.parsed.value);var o=Object.assign({},n);delete o.comparePeriods,delete o.comparePeriodType,delete o.compareDates,De.updateLocation(Object.assign(Object.assign({},o),{},{date:e,period:t},r))},onApplyClicked:function(){if("range"===this.selectedPeriod){var e=this.selectedDateString;if(!e)return;return this.periodValue="range",void this.propagateNewUrlParams(e,"range")}this.setPiwikPeriodAndDate(this.selectedPeriod,this.dateValue)},updateComparisonValuesFromStore:function(){this.comparePeriodType="previousPeriod",this.compareStartDate="",this.compareEndDate="";var e=fo.getPeriodComparisons();if(!(e.length<2)){var t=De.parsed.value.comparePeriodType;if(Tl.includes(t)&&(this.comparePeriodType=t,"custom"===this.comparePeriodType&&"range"===e[1].params.period)){var n;try{n=m.parse(e[1].params.period,e[1].params.date)}catch(l){return}var r=n.getDateRange(),o=jl(r,2),a=o[0],i=o[1];this.compareStartDate=p(a),this.compareEndDate=p(i)}}},updateSelectedValuesFromHash:function(){var e=De.parsed.value.date,t=De.parsed.value.period;this.periodValue=t,this.selectedPeriod=t,this.dateValue=null,this.startRangeDate=null,this.endRangeDate=null;try{m.parse(t,e)}catch(l){return}if("range"===t){var n=m.get(t).parse(e),r=n.getDateRange(),o=jl(r,2),a=o[0],i=o[1];this.dateValue=a,this.startRangeDate=p(a),this.endRangeDate=p(i)}else this.dateValue=h(e),this.setRangeStartEndFromPeriod(t,e)},setRangeStartEndFromPeriod:function(e,t){var n=m.parse(e,t).getDateRange();this.startRangeDate=p(n[0]<Nl?Nl:n[0]),this.endRangeDate=p(n[1]>Il?Il:n[1])},getPeriodDisplayText:function(e){return m.get(e).getDisplayText()},onRangeChange:function(e,t){e&&t?(this.isRangeValid=!0,this.startRangeDate=e,this.endRangeDate=t):this.isRangeValid=!1},isApplyEnabled:function(){return!("range"===this.selectedPeriod&&!this.isRangeValid)&&!(this.isComparing&&"custom"===this.comparePeriodType&&!this.isCompareRangeValid())},closePeriodSelector:function(){this.$refs.root.classList.remove("expanded")},isCompareRangeValid:function(){try{h(this.compareStartDate)}catch(e){return!1}try{h(this.compareEndDate)}catch(e){return!1}return!0},movePeriod:function(e){if(this.canMovePeriod(e)){var t=new Date;switch(null!=this.dateValue&&(t=this.dateValue),this.periodValue){case"day":t.setDate(t.getDate()+e);break;case"week":t.setDate(t.getDate()+7*e);break;case"month":t.setMonth(t.getMonth()+e);break;case"year":t.setFullYear(t.getFullYear()+e);break;default:break}this.dateValue<Nl&&(this.dateValue=Nl),this.dateValue>Il&&(this.dateValue=Il),this.onApplyClicked()}},isPeriodMoveDisabled:function(e){return null===this.dateValue?this.isRangeSelection:this.isRangeSelection||!this.canMovePeriod(e)},canMovePeriod:function(e){if(null===this.dateValue)return!1;var t=-1===e?Nl:Il;return!g(this.dateValue,t,this.periodValue)}}});Bl.render=Ol;var Al=Bl,Ml={class:"reportingMenu"},Ll=["aria-label"],Fl=["data-category-id"],_l=["onClick"],Rl={class:"hidden"},Hl={key:2,role:"menu"},Ul=["href","onClick","title"],$l=["href","onClick"],ql=["onClick"],Wl=Object(X["createElementVNode"])("span",{class:"icon-help"},null,-1),zl=[Wl],Gl={id:"mobile-left-menu",class:"sidenav sidenav--reporting-menu-mobile hide-on-large-only"},Yl=["data-category-id"],Jl={key:1,class:"collapsible collapsible-accordion"},Kl={class:"collapsible-header"},Ql={class:"collapsible-body"},Xl=["onClick","href"],Zl=["onClick","href"];function ec(e,t,n,r,o,a){var i=Object(X["resolveComponent"])("MenuItemsDropdown"),l=Object(X["resolveDirective"])("side-nav");return Object(X["openBlock"])(),Object(X["createElementBlock"])("div",Ml,[Object(X["createElementVNode"])("ul",{class:"navbar hide-on-med-and-down collapsible",role:"menu","aria-label":e.translate("CoreHome_MainNavigation")},[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.menu,(function(t){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{class:Object(X["normalizeClass"])(["menuTab",{active:t.id===e.activeCategory}]),role:"menuitem",key:t.id,"data-category-id":t.id},[t.component?(Object(X["openBlock"])(),Object(X["createBlock"])(Object(X["resolveDynamicComponent"])(t.component),{key:0,onAction:function(n){return e.loadCategory(t)}},null,8,["onAction"])):Object(X["createCommentVNode"])("",!0),t.component?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{key:1,class:"item",tabindex:"5",href:"",onClick:Object(X["withModifiers"])((function(n){return e.loadCategory(t)}),["prevent"])},[Object(X["createElementVNode"])("span",{class:Object(X["normalizeClass"])("menu-icon ".concat(t.icon?t.icon:t.subcategories&&t.id===e.activeCategory?"icon-chevron-down":"icon-chevron-right"))},null,2),Object(X["createTextVNode"])(Object(X["toDisplayString"])(t.name)+" ",1),Object(X["createElementVNode"])("span",Rl,Object(X["toDisplayString"])(e.translate("CoreHome_Menu")),1)],8,_l)),t.component?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("ul",Hl,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(t.subcategories,(function(n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{role:"menuitem",class:Object(X["normalizeClass"])({active:(n.id===e.displayedSubcategory||n.isGroup&&e.activeSubsubcategory===e.displayedSubcategory)&&t.id===e.displayedCategory}),key:n.id},[n.isGroup?(Object(X["openBlock"])(),Object(X["createBlock"])(i,{key:0,"show-search":!0,"menu-title":e.htmlEntities(n.name)},{default:Object(X["withCtx"])((function(){return[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(n.subcategories,(function(r){return Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{class:Object(X["normalizeClass"])(["item",{active:r.id===e.activeSubsubcategory&&n.id===e.displayedSubcategory&&t.id===e.displayedCategory}]),tabindex:"5",href:"#?".concat(e.makeUrl(t,r)),onClick:function(n){return e.loadSubcategory(t,r,n)},title:r.tooltip,key:r.id},Object(X["toDisplayString"])(r.name),11,Ul)})),128))]})),_:2},1032,["menu-title"])):Object(X["createCommentVNode"])("",!0),n.isGroup?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{key:1,href:"#?".concat(e.makeUrl(t,n)),class:"item",onClick:function(r){return e.loadSubcategory(t,n,r)}},Object(X["toDisplayString"])(n.name),9,$l)),n.help?(Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{key:2,class:Object(X["normalizeClass"])(["item-help-icon",{active:e.helpShownCategory&&e.helpShownCategory.subcategory===n.id&&e.helpShownCategory.category===t.id&&n.help}]),tabindex:"5",href:"javascript:",onClick:function(r){return e.showHelp(t,n,r)}},zl,10,ql)):Object(X["createCommentVNode"])("",!0)],2)})),128))]))],10,Fl)})),128))],8,Ll),Object(X["createElementVNode"])("ul",Gl,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(e.menu,(function(t){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{class:"no-padding",key:t.id,"data-category-id":t.id},[t.component?(Object(X["openBlock"])(),Object(X["createBlock"])(Object(X["resolveDynamicComponent"])(t.component),{key:0,onAction:function(n){return e.loadCategory(t)}},null,8,["onAction"])):Object(X["createCommentVNode"])("",!0),t.component?Object(X["createCommentVNode"])("",!0):Object(X["withDirectives"])((Object(X["openBlock"])(),Object(X["createElementBlock"])("ul",Jl,[Object(X["createElementVNode"])("li",null,[Object(X["createElementVNode"])("a",Kl,[Object(X["createElementVNode"])("i",{class:Object(X["normalizeClass"])(t.icon?t.icon:"icon-chevron-down")},null,2),Object(X["createTextVNode"])(Object(X["toDisplayString"])(t.name),1)]),Object(X["createElementVNode"])("div",Ql,[Object(X["createElementVNode"])("ul",null,[(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],null,Object(X["renderList"])(t.subcategories,(function(n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("li",{key:n.id},[n.isGroup?(Object(X["openBlock"])(!0),Object(X["createElementBlock"])(X["Fragment"],{key:0},Object(X["renderList"])(n.subcategories,(function(n){return Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{onClick:function(r){return e.loadSubcategory(t,n)},href:"#?".concat(e.makeUrl(t,n)),key:n.id},Object(X["toDisplayString"])(n.name),9,Xl)})),128)):Object(X["createCommentVNode"])("",!0),n.isGroup?Object(X["createCommentVNode"])("",!0):(Object(X["openBlock"])(),Object(X["createElementBlock"])("a",{key:1,onClick:function(r){return e.loadSubcategory(t,n)},href:"#?".concat(e.makeUrl(t,n))},Object(X["toDisplayString"])(n.name),9,Zl))])})),128))])])])],512)),[[l,{activator:e.sideNavActivator}]])],8,Yl)})),128))])])}function tc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rc(e,t,n){return t&&nc(e.prototype,t),n&&nc(e,n),e}function oc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
 /*!
  * Matomo - free/libre analytics platform
  *
diff --git a/plugins/CoreHome/vue/src/AjaxHelper/AjaxHelper.ts b/plugins/CoreHome/vue/src/AjaxHelper/AjaxHelper.ts
index 0f4a4b8166b..0703b5f0d50 100644
--- a/plugins/CoreHome/vue/src/AjaxHelper/AjaxHelper.ts
+++ b/plugins/CoreHome/vue/src/AjaxHelper/AjaxHelper.ts
@@ -21,6 +21,7 @@ export interface AjaxOptions {
   returnResponseObject?: boolean;
   errorElement?: HTMLElement|JQuery|string;
   redirectOnSuccess?: QueryParameters|boolean;
+  abortable?: boolean;
 }
 
 interface ErrorResponse {
@@ -174,6 +175,8 @@ export default class AjaxHelper<T = any> { // eslint-disable-line
 
   abortController: AbortController|null = null;
 
+  abortable = true;
+
   defaultParams = ['idSite', 'period', 'date', 'segment'];
 
   resolveWithHelper = false;
@@ -243,6 +246,10 @@ export default class AjaxHelper<T = any> { // eslint-disable-line
       helper.resolveWithHelper = true;
     }
 
+    if (options.abortable === false) {
+      helper.abortable = false;
+    }
+
     return helper.send().then((result: R | ErrorResponse | AjaxHelper) => {
       const data = result instanceof AjaxHelper ? result.requestHandle!.responseJSON : result;
 
@@ -504,7 +511,9 @@ export default class AjaxHelper<T = any> { // eslint-disable-line
     }
 
     this.requestHandle = this.buildAjaxCall();
-    window.globalAjaxQueue.push(this.requestHandle);
+    if (this.abortable) {
+      window.globalAjaxQueue.push(this.requestHandle);
+    }
 
     if (this.abortController) {
       this.abortController.signal.addEventListener('abort', () => {
@@ -584,7 +593,9 @@ export default class AjaxHelper<T = any> { // eslint-disable-line
       complete: this.completeCallback,
       headers: this.headers ? this.headers : undefined,
       error: function errorCallback(...args: any[]) { // eslint-disable-line
-        window.globalAjaxQueue.active -= 1;
+        if (self.abortable) {
+          window.globalAjaxQueue.active -= 1;
+        }
 
         if (self.errorCallback) {
           self.errorCallback.apply(this, args);
@@ -642,7 +653,9 @@ export default class AjaxHelper<T = any> { // eslint-disable-line
           this.callback(response, status, request);
         }
 
-        window.globalAjaxQueue.active -= 1;
+        if (self.abortable) {
+          window.globalAjaxQueue.active -= 1;
+        }
         if (Matomo.ajaxRequestFinished) {
           Matomo.ajaxRequestFinished();
         }
diff --git a/plugins/CoreHome/vue/src/SiteSelector/SitesStore.ts b/plugins/CoreHome/vue/src/SiteSelector/SitesStore.ts
index 5aaa99c467c..54026c26075 100644
--- a/plugins/CoreHome/vue/src/SiteSelector/SitesStore.ts
+++ b/plugins/CoreHome/vue/src/SiteSelector/SitesStore.ts
@@ -134,6 +134,7 @@ class SitesStore {
         sitesToExclude,
       }, {
         abortController: this.currentRequestAbort,
+        abortable: false,
       });
     }).then((response) => {
       if (response) {
diff --git a/plugins/TwoFactorAuth/vue/dist/umd.metadata.json b/plugins/TwoFactorAuth/vue/dist/umd.metadata.json
index ed3e9b188b0..081d4e28fca 100644
--- a/plugins/TwoFactorAuth/vue/dist/umd.metadata.json
+++ b/plugins/TwoFactorAuth/vue/dist/umd.metadata.json
@@ -1,7 +1,7 @@
 {
   "dependsOn": [
     "CoreHome",
-    "CorePluginsAdmin",
-    "Login"
+    "Login",
+    "CorePluginsAdmin"
   ]
 }
\ No newline at end of file
