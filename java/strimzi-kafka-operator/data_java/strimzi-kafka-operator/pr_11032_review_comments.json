[
    {
        "title": "Moved bridge configuration setup within the operator"
    },
    {
        "author": {
            "login": "PR Description"
        },
        "body": "### Type of change\r\n\r\n- Refactoring\r\n\r\n### Description\r\n\r\nThis PR fixes #10959 by moving the configuration of the bridge to be generated by the operator within a ConfigMap (actually using the same one that today is used for the metrics and logging configuratio, but with a different entry in the data section) then mounted on the bridge pod and loaded from there.\r\n\r\nNOTE: the temporary change in the .azure/templates/steps/system_test_general.yaml file is for using a custom bridge image which doesn't use its script to generate the configuration anymore. Of course the commit to the file will be reverted before merging the PR. It's there for running STs.\r\n\r\n### Checklist\r\n\r\n- [x] Write tests\r\n- [x] Make sure all tests pass\r\n- [x] Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\r\n- [x] Reference relevant issue(s) and close them after merging\r\n- [x] Update CHANGELOG.md"
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": "i made just a quick pass ... but left bunch of comments."
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "tinaselenge"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "tinaselenge"
        },
        "body": "LGTM, thanks :) "
    },
    {
        "author": {
            "login": "fvaleri"
        },
        "body": "There are a couple of test failures, but the overall approach LGTM.\r\n\r\nI also left a minor comment. Thanks."
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "tinaselenge"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "tinaselenge"
        },
        "body": ""
    },
    {
        "author": {
            "login": "tinaselenge"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "tinaselenge"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "tinaselenge"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "im-konge"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "scholzj"
        },
        "body": "One nit for the CHANGELOG. LGTM otherwise."
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": ""
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "This PR comes together with https://github.com/strimzi/strimzi-kafka-bridge/pull/963\r\nI guess the bridge PR should be merged first, and the bridge 0.32.0 released.\r\nAfter that we can update this PR by setting the new bridge release as well and removing the temporary change in the mentioned azure/templates/steps/system_test_general.yaml to use the right bridge."
    },
    {
        "author": {
            "login": "see-quick"
        },
        "body": "/azp run bridge"
    },
    {
        "author": {
            "login": "azure-pipelines"
        },
        "body": "<samp>\nAzure Pipelines successfully started running 1 pipeline(s).<br>\r\n\n</samp>"
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "/azp run bridge"
    },
    {
        "author": {
            "login": "azure-pipelines"
        },
        "body": "<samp>\nAzure Pipelines successfully started running 1 pipeline(s).<br>\r\n\n</samp>"
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "/azp run regression"
    },
    {
        "author": {
            "login": "azure-pipelines"
        },
        "body": "<samp>\nAzure Pipelines successfully started running 1 pipeline(s).<br>\r\n\n</samp>"
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "/azp run regression"
    },
    {
        "author": {
            "login": "azure-pipelines"
        },
        "body": "<samp>\nAzure Pipelines successfully started running 1 pipeline(s).<br>\r\n\n</samp>"
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "/azp run regression"
    },
    {
        "author": {
            "login": "azure-pipelines"
        },
        "body": "<samp>\nAzure Pipelines successfully started running 1 pipeline(s).<br>\r\n\n</samp>"
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "@scholzj I think I addressed all your comments.\r\nRegarding the changes you see on the values.yaml and HelmResource.java, they are temporary for running the STs and allowing to bring the right operator and bridge for the Helm Charts one. I also opened an issue about that https://github.com/strimzi/strimzi-kafka-operator/issues/11066\r\nOf course these changes will be reverted before merging the PR."
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "actually it was worse. With the above changes I was able to run HelmCharts system tests locally but now the build is failing because of some checks we do on the naming:\r\n\r\n```shell\r\nFAIL  strimzi operator deployment\tstrimzi-kafka-operator/tests/operator_deployment_test.yaml\r\n\t- should have latest image with default image registry when no image is provided\r\n\r\n\t\t- asserts[1] `matchRegex` fail\r\n\t\t\tTemplate:\tstrimzi-kafka-operator/templates/060-Deployment-strimzi-cluster-operator.yaml\r\n\t\t\tDocumentIndex:\t0\r\n\t\t\tPath:\tspec.template.spec.containers[0].image\r\n\t\t\tExpected to match:\r\n\t\t\t\tquay.io/strimzi/operator:(latest|[0-9]+\\.[0-9]+\\.[0-9]+)\r\n\t\t\tActual:\r\n\t\t\t\tquay.io/ppatierno/operator:bridge-config\r\n```\r\n\r\nTbh, there are too many changes to make for having all regression STs running as they are now. What should we do? @scholzj @im-konge ideas?\r\nShould I revert back these changes and live with a failing Helm Charts system test until the bridge release?\r\n\r\n[UPDATE]\r\nI did that to make the build passing. We'll have one regression test (related to Helm Charts) failing for sure."
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "/azp run regression"
    },
    {
        "author": {
            "login": "azure-pipelines"
        },
        "body": "<samp>\nAzure Pipelines successfully started running 1 pipeline(s).<br>\r\n\n</samp>"
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "/azp run regression"
    },
    {
        "author": {
            "login": "azure-pipelines"
        },
        "body": "<samp>\nAzure Pipelines successfully started running 1 pipeline(s).<br>\r\n\n</samp>"
    },
    {
        "author": {
            "login": "ppatierno"
        },
        "body": "So as mentioned on the related bridge PR https://github.com/strimzi/strimzi-kafka-bridge/pull/963, I made a change on the `bridge.version` to set \"latest\" and run `make bridge_version` and then push the changes.\r\nThis way all the needed deployment files were updated for running the STs and they are all green. Of course, we have to revert this change as soon as we have a bridge 0.32.0 release. I will open an issue for that when this PR is merged.\r\n@scholzj would you mind to have another pass and checking if everything looks fine to you now?"
    }
]