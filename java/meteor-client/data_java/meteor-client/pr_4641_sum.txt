**Instruction for Programmer:**

Abstract shared code between the two existing prompt classes to address a bug. Ensure the refactoring complies with project style guidelines, includes comments in complex areas, and works effectively in both development and production environments.